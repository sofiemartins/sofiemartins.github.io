<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analysis &mdash; HiRep  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Writing A Program in HiRep" href="writing_programs.html" />
    <link rel="prev" title="Supported Features" href="supported_features.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> HiRep
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../how_to_cite.html">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_file.html">Input File Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_features.html">Supported Features</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#contractions">Contractions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#connected-two-point-correlation-functions">Connected two point correlation functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#point-sources">Point Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#one-end-trick">One-end Trick</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#implementation-in-hirep">Implementation in HiRep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#disconnected">Disconnected</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cancelling-backwards-propagation">Cancelling Backwards Propagation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#form-factors-and-sequential-sources">Form Factors and Sequential Sources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#two-point-function">Two Point Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#three-point-function">Three Point Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#correlator-ratios-z-v">Correlator Ratios: <img class="math" src="../_images/math/dbc7e1f5267a6d88c87c5a6419f2f5fc9e9ac64b.png" alt="Z_V"/></a></li>
<li class="toctree-l4"><a class="reference internal" href="#correlator-ratios-f-q">Correlator Ratios: <img class="math" src="../_images/math/781f9bfa24edd919ff7c82dd0215eb71cccdcdaf.png" alt="f(q)"/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#estimation-of-disconnected-contributions">Estimation of Disconnected Contributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#conventions">Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#singlet-two-point-functions">Singlet Two-Point Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stochastic-evaluation-of-disconnected-loops">Stochastic Evaluation of Disconnected Loops</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#implemented-source-types">Implemented Source Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debugging-options">Debugging Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mesonic-correlators-of-the-isotriplet">Mesonic Correlators of the Isotriplet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implementation-of-the-point-to-all-propagator">Implementation of the Point-To-All Propagator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mesonic-correlators-of-the-isosinglet">Mesonic Correlators of the Isosinglet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#all-to-all-propagator">All-to-all Propagator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variance-reduction">Variance reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-dilution">Time dilution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-scheme">Implementation Scheme</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="writing_programs.html">Writing A Program in HiRep</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development_manual/coding_conventions.html">Coding Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_manual/testing_setup.html">Testing Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_manual/data_structures.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_manual/auto_generation.html">Auto-Generation of Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_manual/field_geometry.html">Geometry of Field Data in Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_manual/global_objects.html">Global Objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="../../doxygen/build/html/index.html#http://">Full Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HiRep</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/analysis.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="analysis">
<h1>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline"></a></h1>
<section id="contractions">
<h2>Contractions<a class="headerlink" href="#contractions" title="Permalink to this headline"></a></h2>
<section id="connected-two-point-correlation-functions">
<h3>Connected two point correlation functions<a class="headerlink" href="#connected-two-point-correlation-functions" title="Permalink to this headline"></a></h3>
<p>First we choose interpolating operators with the quantum numbers of the
meson we would like to study:</p>
<div class="math">
<p><img src="../_images/math/f545466111e2d2999d5722808e83095d0526931c.png" alt="O_M = \bar{\psi}^{(1)}(x) \Gamma \psi^{(2)}(x)"/></p>
</div><div class="math">
<p><img src="../_images/math/508ef9cd035aca8e7f743ed6780e9870400e4ed4.png" alt="\bar{O}_M = \bar{\psi}^{(2)}(x) \bar{ \Gamma } \psi^{(1)}(x)"/></p>
</div><p>where <img class="math" src="../_images/math/3dbd0e6b621033f07943b06f166f0eecc699fd18.png" alt="\bar{ \Gamma } = \gamma_0 \Gamma^\dagger \gamma_0"/>. The gamma matrix is
chosen to have the same <img class="math" src="../_images/math/269f6fcf80db0dae56bbbc9f5e3282904d1ca486.png" alt="J^{PC}"/> quantum numbers as the meson we want to
create. We then calculate the expectation value to create a meson at <img class="math" src="../_images/math/1b5e577d6216dca3af7d87aa122a0b9b360d6cb3.png" alt="y"/>
and destroy it again at <img class="math" src="../_images/math/888f7c323ac0341871e867220ae2d76467d74d6e.png" alt="x"/>:</p>
<div class="math">
<p><img src="../_images/math/3288863807085e88e6a93546271fe296af1697a6.png" alt="\begin{aligned}
\langle O_M(x) \bar{O}_M'(y) \rangle =&amp; \langle \bar{\psi}^{(1)}(x) \Gamma \psi^{(2)}(x) \bar{\psi}^{(2)}(y) \bar{ \Gamma }' \psi^{(1)}(y) \rangle 
\\
=&amp; \Gamma_{\alpha \beta} \bar{ \Gamma }'_{\gamma \delta} \langle \bar{\psi}^{(1)}_\alpha(x)  \psi^{(2)}_\beta(y) \bar{\psi}^{(2)}_\gamma(y)  \psi^{(1)}_\delta(x) \rangle \\
=&amp; -\Gamma_{\alpha \beta} \bar{ \Gamma }'_{\gamma \delta} \langle \psi^{(2)}_\beta(x) \bar{\psi}^{(2)}_\gamma(y)  \psi^{(1)}_\delta(y) 
\bar{\psi}^{(1)}_\alpha (x) \rangle\end{aligned}"/></p>
</div><p>where the sign in the last line comes from exchanging the anticommuting <img class="math" src="../_images/math/3c8a6c45f480bb8add543ec4ff24917c10e98660.png" alt="\bar{\psi}_\alpha"/> three times. Wick contracting where <img class="math" src="../_images/math/6d53be0c4cf3a5802671adec84c3e41409b3c506.png" alt="\langle \psi_\alpha(x) \bar{\psi}_\beta(y) \rangle = S_{\alpha \beta}(x,y)"/> gives</p>
<div class="math">
<p><img src="../_images/math/0404dba75194ed64462b7b40666fa6c8b5593bce.png" alt="\begin{aligned}
\langle O_M(x) \bar{O}_M'(y) \rangle =&amp; -\Gamma_{\alpha \beta} S^{(2)}_{\beta \gamma} (x,y) \bar{ \Gamma }'_{\gamma \delta} S^{(1)}_{\delta \alpha} (y,x) \\
=&amp; -\text{Tr}\left[ \Gamma S^{(2)} (x,y) \bar{ \Gamma }' S^{(1)} (y,x) \right]\end{aligned}"/></p>
</div><p>To get correlation functions we Fourier transform, ie. sum over all
source and sink seperations while projecting onto the momentum we want
to give to the particle:</p>
<div class="math">
<p><img src="../_images/math/ce33654e53164cabf4a18a37701619c9309cf797.png" alt="\begin{aligned}
C(t - \tau, \vec{p}) =&amp; \sum_{\vec{x} \vec{y}} e^{-i \vec{p}(\vec{x} - \vec{y}) } \langle O_M(\vec{x}, t) O_M'(\vec{y}, \tau)\rangle \\
=&amp; -\sum_{\vec{x} \vec{y}} e^{-i \vec{p}(\vec{x} - \vec{y}) } \text{Tr}\left[ \Gamma S^{(2)} (x,y) \bar{ \Gamma }' S^{(1)} (y,x) \right]\end{aligned}"/></p>
</div><p>here <img class="math" src="../_images/math/acc037f968b680c1fe2cd644f70f3e658d308002.png" alt="x = (\vec{x}, t)"/> and <img class="math" src="../_images/math/9206b88acf1ff9390c2a71f405782122c2ec7671.png" alt="y = (\vec{y}, \tau)"/> and the zero momentum
correlator is:</p>
<div class="math">
<p><img src="../_images/math/9e8e302099e45e40bbe8b3e7359bef73079299ca.png" alt="C(t - \tau, 0) = -\sum_{\vec{x} \vec{y}} \text{Tr}\left[ \Gamma S^{(2)} (x,y) \bar{ \Gamma }' S^{(1)} (y,x) \right]"/></p>
</div><p>We now use <img class="math" src="../_images/math/f97c8f196c4205086cdcb7fbb81aab3b68ac7db6.png" alt="\gamma_5"/> Hermiticity: <img class="math" src="../_images/math/7638991511b3100f62968abc18f5b6c8e4842527.png" alt="\gamma_5 S^\dagger(x,y) \gamma_5 = S(y,x)"/>,</p>
<div class="math" id="equation-eqn-corr">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-eqn-corr" title="Permalink to this equation"></a></span><img src="../_images/math/85ac163933670002bf301ce5e14d8338f8ad4521.png" alt="C(t - \tau, 0) = -\sum_{\vec{x} \vec{y}} \text{Tr}\left[ \gamma_5 \Gamma S^{(2)} (x,y) \bar{ \Gamma }' \gamma_5 S^{\dagger (1)} (x,y) \right]"/></p>
</div></section>
<section id="point-sources">
<h3>Point Sources<a class="headerlink" href="#point-sources" title="Permalink to this headline"></a></h3>
<p>Using a delta function source and solving the Dirac equation gives a
point propagator,</p>
<div class="math">
<p><img src="../_images/math/ff5cf58b25783841d6fe9a7397f3143a4a978beb.png" alt="D_{\alpha a, \beta b} (x,y) S_{\beta b, \gamma c} (y, z) = \delta(x,z) \delta_{ac} \delta_{\alpha \gamma}"/></p>
</div><p>usually <img class="math" src="../_images/math/1ea509f136a7b4b9f0264f8b04a130be248fc845.png" alt="z = (\vec{0}, 0)"/> so we get
<img class="math" src="../_images/math/571cd43cb82bc52aa273abbafe5c3bd124f3352e.png" alt="S(y,0) = \gamma_5 S^{\dagger} (0,y) \gamma_5"/>. Then we use these to
calculate correlation functions,</p>
<div class="math" id="equation-eqn-pointcorr">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-eqn-pointcorr" title="Permalink to this equation"></a></span><img src="../_images/math/47c5179a943ccd8ad384ef82ad2ea619e2fcbbbd.png" alt="C(t, 0) = -\sum_{\vec{x}} \text{Tr} e^{-i \vec{p} \vec{x}} \left[ \gamma_5 \Gamma S (x,0) \bar{ \Gamma }' \gamma_5 S (x,0) \right]"/></p>
</div><p>Translational invariance in the limit of infinitely many gauge
configurations implies <img class="math" src="../_images/math/0562e4344f4bf5670154ebd4288f5f1e04165f51.png" alt="S(x,y) = S(|x - y|)"/>, so the sum over <img class="math" src="../_images/math/a97ade5554f751fe6d3de9db9892c75a19b1810a.png" alt="\vec{y}"/>
in equation <code class="xref eq docutils literal notranslate"><span class="pre">eq:corr</span></code> just gives <img class="math" src="../_images/math/e4762cec46619bf7781cae62216214f909395368.png" alt="V"/> times equation <code class="xref eq docutils literal notranslate"><span class="pre">eq:pointcorr</span></code>. We place the source at the time origin so <img class="math" src="../_images/math/39459690c789d04b59d770a59094482bd27abf81.png" alt="\tau = 0"/>.</p>
</section>
<section id="one-end-trick">
<h3>One-end Trick<a class="headerlink" href="#one-end-trick" title="Permalink to this headline"></a></h3>
<p>For this method it helps to write all the indices out,</p>
<div class="math">
<p><img src="../_images/math/31cf04a38ac76bcd17de28845e1e31a5f1f17b4e.png" alt="C(t - \tau, 0) = -\sum_{\vec{x} \vec{y}} (\gamma_5 \Gamma)_{\alpha \beta} S^{(2)}_{\beta\gamma,bc} (x,y) (\bar{ \Gamma }' \gamma_5)_{\gamma \delta} S^{\dagger (1)}_{\delta \alpha, cb} (x,y)"/></p>
</div><p>Greek indices <img class="math" src="../_images/math/3c792858e4fbfa506cb41187a61a731f40bc80d8.png" alt="\alpha, \beta, \gamma, \delta, ..."/> are spinor indices
and Latin indices <img class="math" src="../_images/math/ecf29c640ba4fe5cfcae3e539928f28431477f88.png" alt="a, b, c, d..."/> are colour indices. The one-end trick
involves inserting a delta function in colour, spin and space.</p>
<div class="math">
<p><img src="../_images/math/29756d99719a9c05cb7ae41e03dade2ed3990d76.png" alt="C(t - \tau, 0) = -\sum_{\vec{x} \vec{y} \vec{z}} (\gamma_5 \Gamma)_{\alpha \beta} S^{(2)}_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) \delta_{\gamma \lambda} \delta_{cd} \delta(\vec{y}, \vec{z}) (\bar{ \Gamma }' \gamma_5)_{\lambda \delta} S^{\dagger (1)}_{\delta \alpha, d b} (\vec{x}, t;\vec{z}, \tau)"/></p>
</div><p>The delta function is aproximated with a <img class="math" src="../_images/math/d0489cea55cb6f83fad4ff9d290c8a9b686cb468.png" alt="Z(2) \times Z(2)"/> noise source on timeslice <img class="math" src="../_images/math/914b2d4b6659b86d3153d5510839dfb254dfc8a3.png" alt="\tau"/></p>
<div class="math">
<p><img src="../_images/math/c433101de56cf662ec2cb602e4521139b5e741b7.png" alt="\delta_{\gamma \lambda} \delta_{cd} \delta(\vec{y}, \vec{z}) \approx \frac{1}{K} \sum_{k = 0}^{K} | \eta^{(k)}_{\gamma c }(\vec{y})\rangle \langle \eta^{(k)}_{\lambda d }(\vec{z}) |"/></p>
</div><p>which is exact in the limit <img class="math" src="../_images/math/b3f51f8998bd456298cc9d08db50c288397362a2.png" alt="K \rightarrow \infty"/>.</p>
<div class="math" id="equation-eq-oet">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-eq-oet" title="Permalink to this equation"></a></span><img src="../_images/math/e45ce31d08b8a527571f07c694fd3b9de3ecdd72.png" alt="C(t - \tau, 0) = -\frac{1}{K} \sum_{k = 0}^{K} \sum_{\vec{x} \vec{y} \vec{z}} (\gamma_5 \Gamma)_{\alpha \beta} S^{(2)}_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) | \eta^{(k)}_{\gamma c }(\vec{y})\rangle \langle \eta^{(k)}_{\lambda d }(\vec{z}) | (\bar{ \Gamma }' \gamma_5)_{\lambda \delta} S^{\dagger (1)}_{\delta \alpha, d b} (\vec{x}, t;\vec{z}, \tau)"/></p>
</div><p>Defining</p>
<div class="math">
<p><img src="../_images/math/9fcad878af688efa0cd97668b7528f3a44a08621.png" alt="\phi^{(k)}_{\beta, b}(\vec{x}, t; \tau) = \sum_{\vec{y}} S^{(2)}_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) | \eta^{(k)}_{\gamma c }(\vec{y})\rangle"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/2b12f0c992b1a315eda197b0ebd5b2b9b31f8b16.png" alt="\phi^{\Gamma (k)}_{\alpha, b}(\vec{x}, t; \tau) = \sum_{\vec{z}} S^{(1)}_{\alpha \delta , b d} (\vec{x}, t;\vec{z}, \tau) (\bar{ \Gamma }' \gamma_5)^{\dagger}_{\delta \lambda} | \eta^{(k)}_{\lambda d }(\vec{z}) \rangle"/></p>
</div><p>the correlator can be evaluated as,</p>
<div class="math">
<p><img src="../_images/math/6fc768814db3e3b6131d2586092cd7b96b02570c.png" alt="C(t - \tau, 0) = -\frac{1}{K} \sum_{k = 0}^{K} \sum_{\vec{x} } (\gamma_5 \Gamma)_{\alpha \beta} \phi^{(k)}_{\beta, b}(\vec{x}, t; \tau) \phi^{\Gamma \dagger (k)}_{\alpha, b}(\vec{x}, t; \tau)"/></p>
</div><section id="implementation-in-hirep">
<h4>Implementation in HiRep<a class="headerlink" href="#implementation-in-hirep" title="Permalink to this headline"></a></h4>
<p>In HiRep the code <code class="docutils literal notranslate"><span class="pre">Spectrum/mk_mesons_with_z2semwall.c</span></code> does two solves to
calculate <img class="math" src="../_images/math/3ca86c793b82920d5d9ae683df8b2b5ef87e8ab5.png" alt="S^{(1)} | \eta \rangle"/> and <img class="math" src="../_images/math/ed722fac31f309045841f4f7fc754e44744e0cf9.png" alt="S^{(2)} (\bar{ \Gamma }' \gamma_5)^{\dagger} | \eta \rangle"/>. HiRep has</p>
<div class="math">
<p><img src="../_images/math/20883c4126422b13d5df015ba543ff16ce34465f.png" alt="\rho = \rho_{ c }(\vec{y})"/></p>
</div><p>a <img class="math" src="../_images/math/d0489cea55cb6f83fad4ff9d290c8a9b686cb468.png" alt="Z(2) \times Z(2)"/> colour vector at all (even) spatial sites <img class="math" src="../_images/math/a97ade5554f751fe6d3de9db9892c75a19b1810a.png" alt="\vec{y}"/> and non-zero only on timeslice <img class="math" src="../_images/math/914b2d4b6659b86d3153d5510839dfb254dfc8a3.png" alt="\tau"/>.</p>
<div class="math">
<p><img src="../_images/math/4197b4936363fc63a9ebdca32592d74dd08062b7.png" alt="\rho^{\alpha}_\beta = \delta_{\alpha \beta} \rho^\alpha"/></p>
</div><p>eg.</p>
<div class="math">
<p><img src="../_images/math/8110a27b7aa63319878ffa6d178507291adb141f.png" alt="\rho^1_\beta = \left( \begin{matrix}
  0 \\
  \rho^1 \\
  0 \\
  0
 \end{matrix} \right)"/></p>
</div><p>It then solves for the four objects</p>
<div class="math">
<p><img src="../_images/math/e87d7118715a32b983e81bd076192181e9aff480.png" alt="\chi^\alpha_\beta = S_{\beta \gamma} \rho^{\alpha}_\gamma"/></p>
</div><p>eg.</p>
<div class="math">
<p><img src="../_images/math/123417c2757124bfa22f874452404573d7d0d023.png" alt="\chi^0_\beta = \left( \begin{matrix}
  S_{00} \rho^0 \\
  S_{10} \rho^0 \\
  S_{20} \rho^0 \\
  S_{30} \rho^0
 \end{matrix} \right)"/></p>
</div><p>For every different <img class="math" src="../_images/math/e7003fd3463f843ee1e53385878369f078d362ad.png" alt="\Gamma"/> that is required it does four more inversions,</p>
<div class="math">
<p><img src="../_images/math/294cfd726b176eabd2bce917b609b96968e906ac.png" alt="\chi^{\Gamma \alpha}_\beta = S_{\beta \gamma} (\Gamma \gamma_5)^\dagger_{\gamma \delta} \rho^{\alpha}_\delta"/></p>
</div><p>before calculating the correlator as,</p>
<div class="math">
<p><img src="../_images/math/550a2c51ad43c08f0b03950119f36ad9ff77616c.png" alt="C(t - \tau, 0) = -\frac{1}{K} \sum_{k = 0}^{K} \sum_{\lambda = 0}^{3}\sum_{\vec{x} } (\gamma_5 \Gamma)_{\alpha \beta} \chi^{\lambda}_{\beta, b}(\vec{x}, t; \tau) \chi^{\Gamma \lambda \dagger}_{\alpha, b}(\vec{x}, t; \tau)"/></p>
</div><p>where the <img class="math" src="../_images/math/cefc603e5658facb747581f9567192993f21c7ab.png" alt="\lambda"/> sum is over the <img class="math" src="../_images/math/d6c8c868656d607bf5557bd64bb81ccdecda9203.png" alt="4"/> spinor components.</p>
<p>We should be able to improve the signal and reduce the number of
inversions with two modifications. First, instead of having a different
noise vector for every spin component we reuse the same noise, i.e.</p>
<div class="math">
<p><img src="../_images/math/4cb50c1852a1561ef2d816a4a5d59843b292bd58.png" alt="\rho^{\alpha}_\beta = \delta_{\alpha \beta} \rho"/></p>
</div><p>for fixed <img class="math" src="../_images/math/27dc86f9f1b1c3435b2403a869b5870c582facea.png" alt="\rho"/>.
Using less noise seems to be generally preferred.</p>
<p>Secondly there is no need to invert for every different <img class="math" src="../_images/math/e7003fd3463f843ee1e53385878369f078d362ad.png" alt="\Gamma"/>. Let,</p>
<div class="math">
<p><img src="../_images/math/5c66e29a9a26dd7e4f468578ad025ba9c083738d.png" alt="\chi^{\Gamma \alpha}_\beta = (\Gamma \gamma_5)^\dagger_{\gamma \alpha} \chi^{\gamma}_\beta"/></p>
</div><p>This is true because,</p>
<div class="math">
<p><img src="../_images/math/9a6f44331156cd597e7cb0c4ffc976a8b3020531.png" alt="(\Gamma \gamma_5)^\dagger_{\gamma \alpha} \chi^{\gamma}_\beta = (\Gamma \gamma_5)^\dagger_{\gamma \alpha}
S_{\beta \delta} \rho^{\gamma}_\delta = (\Gamma \gamma_5)^\dagger_{\gamma \alpha}
S_{\beta \delta} \delta_{\gamma \delta} \rho = (\Gamma \gamma_5)^\dagger_{\gamma \alpha}
S_{\beta \gamma} \rho = S_{\beta \gamma} (\Gamma \gamma_5)^\dagger_{\gamma \alpha} \rho"/></p>
</div><p>then the correlation function is</p>
<div class="math">
<p><img src="../_images/math/550a2c51ad43c08f0b03950119f36ad9ff77616c.png" alt="C(t - \tau, 0) = -\frac{1}{K} \sum_{k = 0}^{K} \sum_{\lambda = 0}^{3}\sum_{\vec{x} } (\gamma_5 \Gamma)_{\alpha \beta} \chi^{\lambda}_{\beta, b}(\vec{x}, t; \tau) \chi^{\Gamma \lambda \dagger}_{\alpha, b}(\vec{x}, t; \tau)"/></p>
</div><p>as before. By using the spin_matrix object in HiRep to construct the
objects <img class="math" src="../_images/math/bc92b065d381afacdffb879754437631c5db3054.png" alt="\chi^{\lambda}_{\beta, b}"/> the correlators can be calculated
with only <img class="math" src="../_images/math/502f85ec4072948253239db8b69e1fe28b5dbfa3.png" alt="4 N_F"/> inversions.</p>
</section>
</section>
<section id="disconnected">
<h3>Disconnected<a class="headerlink" href="#disconnected" title="Permalink to this headline"></a></h3>
<p>The Disconnected contributions occur when we have fermion species of the
same type in the hadron interpolator <img class="math" src="../_images/math/c7066f3e11e724df8b69ef9d1367e7d899fb3257.png" alt="O_M"/>:</p>
<div class="math">
<p><img src="../_images/math/856f99571a9289efa4e66031cef9486ba8bf53d1.png" alt="O_M(x) = \bar{ \psi } (x) \Gamma \psi(x)"/></p>
</div><p>The same manipulations that lead to equation (5) give,</p>
<div class="math">
<p><img src="../_images/math/12e07a000f479861c45bc485164186b21ccf2c38.png" alt="\begin{aligned}
\langle O_M(x) \bar{O}_M'(y) \rangle &amp;=&amp; \langle \bar{\psi}(x) \Gamma \psi(x) \bar{\psi}(y) \bar{ \Gamma }' \psi(y) \rangle \\ 
=&amp; \Gamma_{\alpha \beta} \bar{ \Gamma }'_{\gamma \delta} \langle \bar{\psi}_\alpha(x)  \psi_\beta(y) \bar{\psi}_\gamma(y)  \psi_\delta(x) \rangle \end{aligned}"/></p>
</div><p>There are two allowed Wick contractions,</p>
<div class="math">
<p><img src="../_images/math/2fd2aa5b787c8f993ba1eaec0442b44fd6c669cb.png" alt="\langle O_M(x) \bar{O}_M'(y) \rangle = -\text{Tr}\left[ \Gamma S (x,y) \bar{ \Gamma }' S (y,x) \right] + \text{Tr}\left[ \Gamma S (x,x) \right] \text{Tr} \left[ \bar{ \Gamma }' S (y,y) \right]"/></p>
</div><p>the connected and disconnected contributions. Fourier transforming the
first term gives us the same result as before. For the disconnected part,</p>
<div class="math">
<p><img src="../_images/math/2af4f8c3c3f4fe0d8bba341c70eca286d13145f8.png" alt="\begin{aligned}
D(t - \tau, \vec{p}) = \sum_{\vec{x} \vec{y}} e^{-i \vec{p} (\vec{x} - \vec{y} )} \text{Tr}\left[ \Gamma S (x,x) \right] \text{Tr} \left[ \bar{ \Gamma }' S (y,y) \right]\end{aligned}"/></p>
</div><p>again <img class="math" src="../_images/math/acc037f968b680c1fe2cd644f70f3e658d308002.png" alt="x = (\vec{x}, t)"/> and <img class="math" src="../_images/math/9206b88acf1ff9390c2a71f405782122c2ec7671.png" alt="y = (\vec{y}, \tau)"/>, the zero momentum
correlator is</p>
<div class="math">
<p><img src="../_images/math/9aab1a530c84f235e291190b4f9ae3bae19e9f57.png" alt="\begin{aligned}
D(t - \tau, 0) &amp;=&amp; \sum_{\vec{x} \vec{y}} \text{Tr}\left[ \Gamma S (x,x) \right] \text{Tr} \left[ \bar{ \Gamma }' S (y,y) \right] \\
 =&amp; \sum_{\vec{x}} \text{Tr}\left[ \Gamma S (x,x) \right] \sum_{\vec{y}} \text{Tr} \left[ \bar{ \Gamma }' S (y,y) \right] \end{aligned}"/></p>
</div><p>This means we have to evaluate objects like,</p>
<div class="math">
<p><img src="../_images/math/2bfafa3aac3765e4109f91affc0a56754fd3a5fb.png" alt="\begin{aligned}
d(t) = \sum_{\vec{x}} \text{Tr}\left[ \Gamma S (x,x) \right] = \sum_{\vec{x}} \Gamma_{\alpha \beta} S_{\beta \alpha}(x,x)\end{aligned}"/></p>
</div><p>Using</p>
<div class="math">
<p><img src="../_images/math/7c6dc0814c217f6b9ebceb7964f2b8345c435852.png" alt="\phi^{(k)}_{\beta, b}(\vec{x}, t; \tau) = \sum_{\vec{y}} S_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) | \eta^{(k)}_{\gamma c }(\vec{y})\rangle"/></p>
</div><p>which implies</p>
<div class="math">
<p><img src="../_images/math/427ab2a09e15856625996244b6592caea5641524.png" alt="\begin{aligned}
\frac{1}{K} \sum_{k}^K \sum_{\vec{x}} \text{Tr} \left[ \langle \eta^{(k)}(\vec{x}) | \Gamma | \phi^{(k)} (\vec{x}, t; \tau) \rangle \right] =&amp; \frac{1}{K} \sum_{k}^K \sum_{\vec{x}} \Gamma_{\beta \gamma} | \phi^{(k)}_{\gamma, b}(\vec{x}, t; \tau) \rangle \langle \eta^{(k)}_{\beta b }(\vec{x}) | \\
 =&amp; \frac{1}{K} \sum_{k}^K \sum_{\vec{x}} \Gamma_{\beta \gamma} \sum_{\vec{y}} S_{\gamma \alpha,b c} (\vec{x}, t; \vec{y}, \tau) 
| \eta^{(k)}_{\alpha c }(\vec{y})\rangle \langle \eta^{(k)}_{\beta b }(\vec{x}) |\end{aligned}"/></p>
</div><p>Using the limit <img class="math" src="../_images/math/b3f51f8998bd456298cc9d08db50c288397362a2.png" alt="K \rightarrow \infty"/> this becomes,</p>
<div class="math">
<p><img src="../_images/math/ff083378aff9b9ec1558b49833f935d373ac430d.png" alt="\begin{aligned}\sum_{\vec{x}} \Gamma_{\beta \gamma} \sum_{\vec{y}} S_{\gamma \alpha,b c} (\vec{x}, t; \vec{y}, \tau) \delta_{bc} \delta_{\alpha \beta} \delta(\vec{y}, \vec{x}) =&amp; 
\sum_{\vec{x}} \Gamma_{\beta \gamma} S_{\gamma \beta,b b} (\vec{x}, t; \vec{x}, \tau) \\
d(t, \tau) =&amp; \text{Tr} \left[ \Gamma S(\vec{x}, t; \vec{x}, \tau) \right]\end{aligned}"/></p>
</div><p>We want only cases where <img class="math" src="../_images/math/0c3383f18e94d28b73be9c677341301ce02c4233.png" alt="t = \tau"/> so we need either (a) four noise
vectors on every timeslice or (b) noise vectors that are nonzero on all
timeslices. In case (b) we would evaluate,</p>
<div class="math">
<p><img src="../_images/math/1beb7ad696949a9153ecd972cbb3e6b51ee52872.png" alt="\begin{aligned}\frac{1}{K} \sum_{k}^K \sum_{\vec{x}} \text{Tr} \left[ \langle \eta^{(k)}(\vec{x}, t) | \Gamma | \phi^{(k)} (\vec{x}, t) \rangle \right] \end{aligned}"/></p>
</div><p>with</p>
<div class="math">
<p><img src="../_images/math/5e24bae1a150b15bebc3854d17bedbe0b64b6ea1.png" alt="\phi^{(k)}_{\beta, b}(\vec{x}, t) = \sum_{\vec{y}} S_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) | \eta^{(k)}_{\gamma c }(\vec{y}, \tau)\rangle"/></p>
</div></section>
<section id="cancelling-backwards-propagation">
<h3>Cancelling Backwards Propagation<a class="headerlink" href="#cancelling-backwards-propagation" title="Permalink to this headline"></a></h3>
<p>The two point function evaluated in the centre of the lattice is
(including the backward propagating part to give the extra factor of
<img class="math" src="../_images/math/d94997a2318fec7e8e5bc4d8d79bb633675f9411.png" alt="2"/>),</p>
<div class="math">
<p><img src="../_images/math/66f5489243e9a9512f9039a9740eafb216e56572.png" alt="C(T/2, \vec{p}) = \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) }   2 e^{- E_\pi(\vec{p}) (T/2) }"/></p>
</div><p>therefore</p>
<div class="math">
<p><img src="../_images/math/917cda63fb6239eb1f3fcaa20faf80c4ca3a6bf5.png" alt="\frac{1}{2} C(T/2, \vec{p}) e^{ - E_\pi(\vec{p}) (T/2 - t)  } = \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) (T - t) }"/></p>
</div><p>then</p>
<div class="math">
<p><img src="../_images/math/0d1be78449128d9311bf10a720d9124585da22c9.png" alt="C_{\rightarrow}(t, \vec{p}) = C(t, \vec{p}) - \frac{1}{2} C(T/2, \vec{p}) e^{ - E_\pi(\vec{p}) (T/2 - t)  }"/></p>
</div><p>is the forward propagating part only. <img class="math" src="../_images/math/b9683135f2b4841847be6bd3b4b1c58444885a03.png" alt="E_\pi(\vec{p})"/> is obtained by
fitting the zero momentum correlator and using
<img class="math" src="../_images/math/df64cb411c54b1de82de333933abb3d5ef40c9ad.png" alt="E(\vec{p}) = \sqrt{m_\pi^2 + \vec{p}^2}"/>. The factor <img class="math" src="../_images/math/0920e5cb37cd98bf06c240d72feba69c2fc54248.png" alt="C(T/2, \vec{p})"/>
can be obtained also from the zero momentum correlator, by fitting to
obtain <img class="math" src="../_images/math/0e93cbaa34f7adf89284350a332e492c18602810.png" alt="|Z_\pi|^2"/> and using the fact that this is momentum independent.
Since <img class="math" src="../_images/math/31fdf41b39df23c95e52c5aef07f59d9adf82f3c.png" alt="0"/> momentum results are used this might not be too noisy.</p>
<p>Alternatively the Wilson action is invariant under</p>
<div class="math">
<p><img src="../_images/math/b3ff29b1539e164d19084d6044e279182b2fbf52.png" alt="\begin{aligned}\psi(x) \rightarrow {\cal P_\mu}[ \psi(x) ] = \gamma_\mu \psi( P_\mu[x]) \\
\bar{ \psi } (x) \rightarrow {\cal P_\mu}[ \bar{ \psi } (x) ] = \bar{ \psi }( P_\mu[x])  \gamma_\mu \end{aligned}"/></p>
</div><p>where <img class="math" src="../_images/math/ecc34e39768ebd063dea815c8ac237a7472ee08a.png" alt="P_\mu[x]"/> reverses the sign of all the components of <img class="math" src="../_images/math/888f7c323ac0341871e867220ae2d76467d74d6e.png" alt="x"/> except
the <img class="math" src="../_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> one. Time reversal corresponds to <img class="math" src="../_images/math/ac2ece959f643074af2153817603163f5f115b42.png" alt="{\cal T} = {\cal P}_1{\cal P}_2{\cal P}_3"/>.</p>
<div class="math">
<p><img src="../_images/math/a42940f71717af51c9988e77d0f81617b7e808ef.png" alt="\begin{aligned}\psi(x) \rightarrow {\cal T}[ \psi(x) ] = \gamma_0 \gamma_5 \psi( T[x]) \\
\bar{ \psi } (x) \rightarrow {\cal T}[ \bar{ \psi } (x) ] = \bar{ \psi }( T[x])  \gamma_5 \gamma_0 \end{aligned}"/></p>
</div><p>Using this the T symmetry of operators used to construct the correlators
can be calculated to calculate the sign on the backwards propagating
part.</p>
<div class="math">
<p><img src="../_images/math/9e2cdcd037b98387b6431983a6f32014b843818e.png" alt="\langle O_1(t) O_2(0) \rangle = C(t) = A \left( e^{ -Et} + \tau_1 \tau_2 e^{-E(T - t)}\right)"/></p>
</div><p>where <img class="math" src="../_images/math/a2d0c75e8059ddb4425ce4fd5436dabfea99a8fa.png" alt="\tau_i = \pm 1"/> is the <img class="math" src="../_images/math/d08425a3106c1d179ce2e28fd21816b2768c0c81.png" alt="{\cal T}"/> eigenvalue of <img class="math" src="../_images/math/50d122a0808d59602c802c81b8ea039e89a2ca79.png" alt="O_i"/>.</p>
<p>We mostly use correlators where <img class="math" src="../_images/math/685abc358fc2e124df79c9cc8c210134c8ea40ce.png" alt="O_1 = O_2"/> so <img class="math" src="../_images/math/6b3fbfbc42a5c401ba38f0099efb95b32fd23b55.png" alt="\tau_1 \tau_2 = 1"/> then
the correlator is</p>
<div class="math">
<p><img src="../_images/math/527ba1e442395f0bb284c30e016d88ef40ea317c.png" alt="C_{pp}(t, \vec{p}) = \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) }   \left( e^{- E_\pi(\vec{p})t } + e^{- E_\pi(\vec{p})(T - t) } + e^{- E_\pi(\vec{p})(2T - t) } + \ldots \right)"/></p>
</div><p>The subscript on <img class="math" src="../_images/math/229c6cf4da65114784aa75c97bd3425c67e56fd8.png" alt="C_{pp}"/> refers to the fact that both propagators used
periodic boundary conditions. We want to cancel the backwards
propagating part which can be done by solving the forward propagator
<img class="math" src="../_images/math/133e78e179100809b5dd4fb7de3fa30d11b631cb.png" alt="S(0,x)"/> using antiperiodic time bc’s and the backward <img class="math" src="../_images/math/705174e8b53ba1e52c289c9be5790065e59c62d6.png" alt="S(x,0)"/> with
periodic time bc’s to give an extra minus sign,</p>
<div class="math">
<p><img src="../_images/math/6f23624912a218b116b4e662ecdb310f3a638b97.png" alt="C_{ap}(t, \vec{p}) = \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) }   \left( e^{- E_\pi(\vec{p})t } - e^{- E_\pi(\vec{p})(T - t) } + e^{- E_\pi(\vec{p})(2T - t) } - \ldots \right)"/></p>
</div><p>so,</p>
<div class="math">
<p><img src="../_images/math/6f6f69970315d278e6c543f5a1f15a1b68f5cf22.png" alt="C_{ap}(t, \vec{p}) + C_{p}(t, \vec{p}) = \frac{ 2 |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) }   \left( e^{- E_\pi(\vec{p})t } + e^{- E_\pi(\vec{p})(2T - t) } + \ldots \right)"/></p>
</div><p>cancelling the subleading exponential. This method requires two
inversions and the calculation of</p>
<div class="math">
<p><img src="../_images/math/4553781eb9166a54032532c6c1804cb4576c0d60.png" alt="S_{A \pm P} (x,y) = S_A(x,y) \pm S_P(x,y)"/></p>
</div><p>Where the subscript refers to (A)ntiperiodic/(P)eriodic boundary conditions. Then,</p>
<div class="math">
<p><img src="../_images/math/be9be31da9735449e7b1715788741f9602bf69ff.png" alt="C_{\pm}(t - \tau, 0) = -\sum_{\vec{x} \vec{y}} \text{Tr}\left[ \gamma_5 \Gamma S_{A \pm P} (x,y) \bar{ \Gamma }' \gamma_5 S_{A \pm P} (x,y) \right]"/></p>
</div><p>where <img class="math" src="../_images/math/a961c517f8af8e92fe7dd367db6bfb1a07741f41.png" alt="C_{+}(t - \tau, 0)"/> gives the forward propagating part from <img class="math" src="../_images/math/31fdf41b39df23c95e52c5aef07f59d9adf82f3c.png" alt="0"/>
to <img class="math" src="../_images/math/e8dea8254118f111b5fb20895b03528c17566f06.png" alt="T"/> and <img class="math" src="../_images/math/28257b39296193a44ba229a2627b66f31fba95f3.png" alt="C_{-}(t - \tau, 0)"/> gives the backwards propagating part
from <img class="math" src="../_images/math/4d28276dfcd8e0a92c2fbe91383110adf198ccfc.png" alt="2T"/> to <img class="math" src="../_images/math/e8dea8254118f111b5fb20895b03528c17566f06.png" alt="T"/>.</p>
</section>
<section id="form-factors-and-sequential-sources">
<h3>Form Factors and Sequential Sources<a class="headerlink" href="#form-factors-and-sequential-sources" title="Permalink to this headline"></a></h3>
<p>The electromagnetic form factor of a ‘pion’ requires the evaluation of
the matrix element</p>
<div class="math">
<p><img src="../_images/math/f753d1112ce92582018cdc1ed24b1aabc496fb4c.png" alt="\langle \pi(p_f) | V_\mu | \pi(p_i) \rangle = (p_i + p_f)_\mu f(q^2)"/></p>
</div><p>where <img class="math" src="../_images/math/f397c60bfa85eeac4bd7d2e6c22893a8a92a8bcb.png" alt="q^2 = (p_i - p_f)^2"/> and</p>
<div class="math">
<p><img src="../_images/math/a9f955836f57fdf762d7851e5eddd497457faad5.png" alt="V_\mu = q_u \bar{u} \gamma_\mu u + q_d \bar{d} \gamma_\mu d"/></p>
</div><p>is the electromagnetic current and <img class="math" src="../_images/math/a554e42bdccfdc2c87802f5d26d2fff6d3c72a6f.png" alt="q_i"/> is the charge of the fermion <img class="math" src="../_images/math/5aa339d4daf45a810dda332e3c80a0698e526e04.png" alt="i"/>. This
is the local (not conserved) current, so there will be a factor <img class="math" src="../_images/math/dbc7e1f5267a6d88c87c5a6419f2f5fc9e9ac64b.png" alt="Z_V"/>
for renormalization. The matrix elements required look like:</p>
<div class="math">
<p><img src="../_images/math/507a3a0b4dfc859e68a39f9811617b3f2da8bcd7.png" alt="\begin{aligned}
C_3(t_f,t,t_i,\vec{p_i}, \vec{p_f}) = Z_V \sum_{\vec{x} \vec{y} \vec{z}} e^{-i\vec{p_f}(\vec{x} - \vec{y}) } e^{i\vec{p_i} (\vec{y} - \vec{z)}}\langle 0 | \bar{u} \gamma_5 d ( \vec{x}, t_f)  V_0(\vec{y}, t) \bar{d} \gamma_5 u (\vec{z}, t_i) | 0 \rangle\end{aligned}"/></p>
</div><p>We take the <img class="math" src="../_images/math/7ce60f266b2df2bc6b500297a81535521758494a.png" alt="\mu = 0"/> component since this is statistically cleaner and
also nonzero independant of the momentum direction. The contractions
give three propagators eg. taking the <img class="math" src="../_images/math/d602b45438b78a4f6772bc17cff1d8eaa02cc39a.png" alt="\bar{d} \gamma_\mu d"/> part of
<img class="math" src="../_images/math/ae821b75d3b31332ffe9271486a01de549b38d64.png" alt="V_\mu"/>,</p>
<div class="math">
<p><img src="../_images/math/86b789794b169c01740b7364d92d70f7336b965c.png" alt="\begin{aligned}
Z_V \sum_{\vec{x} \vec{y} \vec{z}} e^{-i\vec{p_f}(\vec{x} - \vec{y}) } e^{-i\vec{p_i} (\vec{y} - \vec{z} ) } Tr \left[ S_u(\vec{z},t_i;\vec{x},t_f) \gamma_5 S_d(\vec{x},t_f;\vec{y},t)  \gamma_0 S_d(\vec{y},t;\vec{z},t_i) \gamma_5  \right]\end{aligned}"/></p>
</div><p>There are also disconnected contributions from contracting the two
fermions in the current together but we ignore those. The usual
sequential source trick consists of solving</p>
<div class="math">
<p><img src="../_images/math/264b48abc6b5e8ab19b9efa183fdcde8c321ed17.png" alt="S_u(\vec{x}, t; \vec{z}, t_i) = \sum_{\vec{y},\tau} D_u ( \vec{x}, t; \vec{y},\tau)  \delta(\vec{y}, \tau; \vec{z}, t_i)"/></p>
</div><p>to get the point-to-all propagator (for a specific <img class="math" src="../_images/math/26169ee0e3152c0bdacb360597a5cbf8e8848f30.png" alt="\vec{z}"/> and <img class="math" src="../_images/math/f655bd7f2c801f6c308297962160678a2e5f6c20.png" alt="t_i"/>
as well as dropping the sum over <img class="math" src="../_images/math/26169ee0e3152c0bdacb360597a5cbf8e8848f30.png" alt="\vec{z}"/> and using translational
invarience). Then taking a single timeslice of the propagator
<img class="math" src="../_images/math/d8e2f47a0deb3fc5603c90d478f565be3c88b92d.png" alt="S_u(\vec{x}, t_f; \vec{z}, t_i)"/> and solving,</p>
<div class="math">
<p><img src="../_images/math/ae6ffcc722ea504ad11c53faed26d02ec2cecb18.png" alt="\begin{aligned}D_d ( \vec{x},t_f; \vec{y}, t ) G_{du}(\vec{y}, t; \vec{p_f}; t_f; \vec{z}, t_i) =&amp; e^{i\vec{p_f} \vec{x}} \gamma_5 S_u(\vec{x}, t_f; \vec{z}, t_i) \\
G_{du}(\vec{y}, t; \vec{p_f}; t_f; \vec{z}, t_i) =&amp; \sum_{ \vec{x} } e^{i\vec{p_f} \vec{x}} S_d(\vec{y},t; \vec{x}, t_f ) \gamma_5 S_u(\vec{x}, t_f; \vec{z}, t_i)\end{aligned}"/></p>
</div><p>to get the all-to-all-to-point contribution. Then</p>
<div class="math">
<p><img src="../_images/math/68c9a13c691faa6acbc0a1235ffd5f340148b4c3.png" alt="\begin{aligned}\gamma_5 \left[ G_{du}(\vec{y}, t; \vec{p_f}; t_f; \vec{z}, t_i)  \right]^\dagger \gamma_5 &amp;=&amp; \sum_{ \vec{x} } e^{-i\vec{p_f} \vec{x}} \gamma_5 S_u^\dagger (\vec{x}, t_f;\vec{y},t ) \gamma_5 \gamma_5 \gamma_5 \gamma_5 \gamma_5 S_d^\dagger (\vec{z}, t_i;\vec{x}, t_f) \gamma_5 \\
=&amp; \sum_{ \vec{x} } e^{-i\vec{p_f} \vec{x}} S_u (\vec{z}, t_i;\vec{x}, t_f) \gamma_5 S_d (\vec{x}, t_f;\vec{y},t ) \\
=&amp; G_{ud}(\vec{z}, t_i; t_f; \vec{p_f}; \vec{y}, t )\end{aligned}"/></p>
</div><div class="math" id="equation-eq-3ptfn">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-eq-3ptfn" title="Permalink to this equation"></a></span><img src="../_images/math/40ff25e638d127475500f68ee85fb1a1ffcf138e.png" alt="\begin{aligned}
C_3(t_f,t,t_i, \vec{p_i}, \vec{p_f}) = Z_V \sum_{\vec{y} } e^{-i(\vec{p_i} - \vec{p_f})\vec{y}} Tr \left[ G_{ud}(\vec{z}, t_i; t_f; \vec{p_f}; \vec{y}, t )  \gamma_0 S_d(\vec{y},t;\vec{z},t_i) \gamma_5 \right]\end{aligned}"/></p>
</div><p>This <img class="math" src="../_images/math/dbc7e1f5267a6d88c87c5a6419f2f5fc9e9ac64b.png" alt="Z_V"/> factor is unknown. We show how to calculate it later, or
cancel it, but an alternative is to use the conserved vector current in
place of the local current:</p>
<div class="math">
<p><img src="../_images/math/71f4d047dbf7387839dd193f41d7c01b2cd7796d.png" alt="V_\mu = \frac{1}{2} \left[ \bar{\psi}(x + \mu)(1 + \gamma_\mu)U_\mu^\dagger(x) \psi(x) - \bar{\psi}(x)(1 - \gamma_\mu)U_\mu^\dagger(x) \psi(x + \mu) \right]"/></p>
</div><p>The trace in <a class="reference internal" href="#equation-eq-3ptfn">(4)</a> becomes</p>
<div class="math">
<p><img src="../_images/math/66132e46c705d204cee505be331c31d91fb15a31.png" alt="\begin{aligned}
Tr[ S_d(\vec{y},t+1;\vec{z},t_i) \gamma_5 (1 + \gamma_0)U_0^\dagger(\vec{y},t) G_{ud}(\vec{z}, t_i; t_f; \vec{p_f}; \vec{y}, t )   - \\ \nonumber
S_d(\vec{y},t;\vec{z},t_i) \gamma_5 (1 - \gamma_0)U_0(\vec{y},t) G_{ud}(\vec{z}, t_i; t_f; \vec{p_f}; \vec{y}, t+1 ) ]\end{aligned}"/></p>
</div><p>If we use this then all the following formulas are the same except <img class="math" src="../_images/math/13b1e719a0a20b6d1af64b2699ec98f06b653f63.png" alt="Z_V \rightarrow 1"/>.</p>
<p>There is an alternative that doesn’t require the sequential source
trick. Using the properties of our noise sources,</p>
<div class="math">
<p><img src="../_images/math/b5c33228d97918c5e1b8d6752e2841110354c17b.png" alt="S_d(\vec{x},t_f;\vec{y},t) \approx \frac{1}{K} \sum_{i=0}^K | \psi^{(i)}(\vec{x},t_f) \rangle \langle \eta^{(i)}(\vec{y},t) |"/></p>
</div><p>the three point correlation function becomes,</p>
<div class="math">
<p><img src="../_images/math/9b32bec2fae94d980940990ed529c13d9cd0694a.png" alt="\begin{aligned}
Z_V \frac{1}{K} \sum_{i=0}^K \sum_{\vec{x} \vec{y} } e^{-i\vec{p_f}(\vec{x} - \vec{y}) } e^{i\vec{p_i} \vec{y}} Tr \left[  \langle \eta^{(i)}(\vec{y},t) | \gamma_0 S_d(\vec{y},t;\vec{0},0) \gamma_5  S_u(\vec{0},0;\vec{x},t_f) \gamma_5 | \psi^{(i)}(\vec{x},t_f) \rangle \right] \\
Z_V \frac{1}{K} \sum_{i=0}^K \sum_{\vec{x} \vec{y} } e^{-i\vec{p_f}(\vec{x} - \vec{y}) } e^{i\vec{p_i} \vec{y}} Tr \left[  \langle \eta^{(i)}(\vec{y},t) | \gamma_0 S_d(\vec{y},t;\vec{0},0) S_u^{\dagger}(\vec{x},t_f;\vec{0},0) | \psi^{(i)}(\vec{x},t_f) \rangle \right]\end{aligned}"/></p>
</div><p>Using this method we can inject arbitrary momentum at the source without
the need for extra inversions.</p>
<section id="two-point-function">
<h4>Two Point Function<a class="headerlink" href="#two-point-function" title="Permalink to this headline"></a></h4>
<p>A complete set of hadrons is given by,</p>
<div class="math">
<p><img src="../_images/math/2b818e3f582855b8c87a8a1ff5789a4883212d4c.png" alt="\sum_n \frac{ | n \rangle \langle n |}{ 2 E_n V}"/></p>
</div><p>the first term is the pion. The two point function (from point sources) is,</p>
<div class="math">
<p><img src="../_images/math/04814882db5ca07a6dc260f352f445cccdde40fc.png" alt="\begin{aligned}
C(t, \vec{p}) &amp;=&amp; \sum_{\vec{x}} e^{-i \vec{p} \vec{x}} \langle O_\pi (\vec{x}, t) O^\dagger_\pi (\vec{0}, 0)\rangle \\
&amp;=&amp; \sum_{\vec{x}} \sum_n e^{i \vec{p} \vec{x}}  
\frac{ \langle 0 | O_\pi (\vec{x}, t)  | n \rangle \langle n | O^\dagger_\pi (\vec{0}, 0)| 0 \rangle }{ 2 E_n } \end{aligned}"/></p>
</div><p>Use <img class="math" src="../_images/math/5da4be553810c90a051d54450bd817bae6c77803.png" alt="\sum_{ \vec{y} } e^{-i\vec{p} \vec{y}} O^\dagger_n (\vec{y}, 0) | 0 \rangle  = | n(\vec{p}) \rangle"/>, the time evolution operator <img class="math" src="../_images/math/a8bc9ff01351620a7b0ff59f804fb4ac922e1391.png" alt="e^{-Ht}"/> and also the fact that the lightest meson dominates the sum to get,</p>
<div class="math">
<p><img src="../_images/math/1458e6e74bcd2eec4d751bb11373e91cc2dbfb2a.png" alt="\begin{aligned}
C(t, \vec{p}) 
&amp;=&amp; \sum_{\vec{x} \vec{y} \vec{z}} \sum_{\vec{p'} } e^{-i \vec{p} \vec{x}}  
\frac{ \langle 0 | O_\pi (\vec{x}, 0)  O^\dagger_\pi (\vec{y}, 0) e^{i \vec{p'} \vec{y} }   | 0 \rangle \langle 0 | e^{i \vec{p'} \vec{z} } O_\pi (\vec{z}, 0) O^\dagger_\pi (\vec{0}, 0)| 0 \rangle }{ 2 E_\pi(\vec{p'}) } e^{- E_\pi(\vec{p'}) t }\end{aligned}"/></p>
</div><p>The sum over <img class="math" src="../_images/math/1596b6aec79b4a03f6bc0bf48a198f59724b6552.png" alt="\vec{p'}"/> gives a delta function leaving,</p>
<div class="math">
<p><img src="../_images/math/a61220b64c4027c595e624b151ed9e02f2ab2411.png" alt="\begin{aligned}
C(t, \vec{p}) 
&amp;=&amp; \sum_{\vec{x} \vec{y} } e^{-i \vec{p} \vec{x}}  
\frac{ \langle 0 | O_\pi (\vec{x}, 0)  O^\dagger_\pi (\vec{y}, 0) | 0 \rangle \langle 0 | O_\pi (\vec{y}, 0) O^\dagger_\pi (\vec{0}, 0) | 0 \rangle }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) t }\end{aligned}"/></p>
</div><p>Translational invarience lets us write,</p>
<div class="math">
<p><img src="../_images/math/e9946da8f1c36974708916f5a60b4c51b4880f61.png" alt="\begin{aligned}
C(t, \vec{p}) 
&amp;=&amp; \sum_{\vec{x} \vec{y} } e^{-i \vec{p} ( \vec{x} - \vec{y} ) } e^{ -i \vec{p} \vec{y} }  
\frac{ \langle 0 | O_\pi (\vec{0}, 0)  O^\dagger_\pi (\vec{x}-\vec{y}, 0) | 0 \rangle \langle 0 | O_\pi (\vec{y}, 0) O^\dagger_\pi (\vec{0}, 0)| 0 \rangle }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) t }\end{aligned}"/></p>
</div><p>Now changing variables gives us two Fourier transforms,</p>
<div class="math">
<p><img src="../_images/math/098115b8a3362483c15c92da5821103cfdca9f9f.png" alt="\begin{aligned}
C(t, \vec{p}) =&amp; \frac{ \langle 0 |  O_\pi (\vec{0}, 0) | \pi(p) \rangle \langle \pi(p) | O^\dagger_\pi (\vec{0}, 0)| 0 \rangle }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) t }\end{aligned}"/></p>
</div><p>and finally using the time evolution operator we get,</p>
<div class="math">
<p><img src="../_images/math/884f20c7124de3eaf498bf8b08b63ed4f5c5af81.png" alt="\begin{aligned} C(t, \vec{p}) =&amp; \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) t }\end{aligned}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/5a6920b8fc7c458cd77529f8494d1078d0c21341.png" alt="Z_\pi = \langle \pi(p) | O^\dagger_\pi (\vec{0}, 0)| 0 \rangle"/></p>
</div></section>
<section id="three-point-function">
<h4>Three Point Function<a class="headerlink" href="#three-point-function" title="Permalink to this headline"></a></h4>
<p>In less detail we insert two complete sets of states into the correlator
( point sources so <img class="math" src="../_images/math/3cde9c0aa128ca0f35930133177cf2618a42095a.png" alt="(\vec{x_i}, t_i) = (\vec{0}, 0)"/> )</p>
<div class="math">
<p><img src="../_images/math/244fa92d94eb659afc0bdb9dfb69f7e615becc7d.png" alt="\begin{aligned}\langle \pi(p_f) | V_\mu | \pi(p_i) \rangle =&amp; \langle 0| O(\vec{p_f}, t_f) V_\mu(\vec{x}, t) O^\dagger(\vec{p_i}, t_i) |0\rangle \\
 =&amp; \langle 0| O(\vec{0}, 0) | \pi(\vec{p_f}) \rangle \frac{e^{-(t_f - t) E_\pi(\vec{p_f}) }}{2 E_\pi(\vec{p_f}) } \langle \pi(\vec{p_f}) | V_\mu(\vec{0}, 0) | \pi(\vec{p_i}) \rangle \\ \times&amp; \frac{e^{-(t - t_i) E_\pi(\vec{p_i}) }} {2 E_\pi(\vec{p_i}) } \langle \pi(\vec{p_i}) | O^\dagger(\vec{0}, 0) |0 \rangle \\ \nonumber
=&amp;  \frac{ Z_{\pi, f}^\dagger Z_{\pi, i} }{4 E(\vec{p_f}) E(\vec{p_i}) } \langle \pi(\vec{p_f}) | V_\mu(\vec{0}, 0) | \pi(\vec{p_i}) \rangle  e^{-(t_f - t) E_\pi(\vec{p_f}) -(t-t_i) E_\pi(\vec{p_i}) }\end{aligned}"/></p>
</div><p>if <img class="math" src="../_images/math/fb8e7e9b7fd83269c4b27d3ab0041aa52b9ab61a.png" alt="t &lt; t_f"/> we have the backwards contribution and the exponential
changes to</p>
<div class="math">
<p><img src="../_images/math/fdf2534096363f567311c50537fe02e9cc413fbb.png" alt="-e^{-(t - t_f) E_\pi(\vec{p_f}) -(T - t + t_i) E_\pi(\vec{p_i}) }"/></p>
</div></section>
<section id="correlator-ratios-z-v">
<h4>Correlator Ratios: <img class="math" src="../_images/math/dbc7e1f5267a6d88c87c5a6419f2f5fc9e9ac64b.png" alt="Z_V"/><a class="headerlink" href="#correlator-ratios-z-v" title="Permalink to this headline"></a></h4>
<p><img class="math" src="../_images/math/dbc7e1f5267a6d88c87c5a6419f2f5fc9e9ac64b.png" alt="Z_V"/> can be obtained as follows: The ratio,</p>
<div class="math">
<p><img src="../_images/math/9ce4721818938c682b57c268369892d1f62d8b76.png" alt="\begin{aligned}\frac{ C_{\rightarrow}(t_f, \vec{0}) }{ C_3(t_f, t, \vec{p_i}, \vec{p_f}) } =&amp;  
\frac{ \frac{ |Z_\pi( \vec{0} )|^2 }{ 2 m_\pi }   e^{- m_\pi t_f }  }{ \frac{ |Z_\pi( \vec{0} )|^2 }{4 m_\pi^2 } \langle \pi(\vec{0}) | V_\mu | \pi(\vec{0}) \rangle e^{-(t_f - t) m_\pi -t m_\pi } } \\
=&amp; \frac{ 1  }{ \frac{ 1 }{2 m_\pi } \langle \pi(\vec{0}) | V_\mu | \pi(\vec{0}) \rangle } \\
=&amp; \frac{ 1  }{ \frac{ 1 }{2 m_\pi } 2 m_pi f(0)/Z_V } = Z_V.\end{aligned}"/></p>
</div><p>Where we used that the renormalized form factor <img class="math" src="../_images/math/daa0ced8a140acb3b3312f2449e9e86e6fdfe6e4.png" alt="f(0) = 1"/></p>
</section>
<section id="correlator-ratios-f-q">
<h4>Correlator Ratios: <img class="math" src="../_images/math/781f9bfa24edd919ff7c82dd0215eb71cccdcdaf.png" alt="f(q)"/><a class="headerlink" href="#correlator-ratios-f-q" title="Permalink to this headline"></a></h4>
<p>There are various ways to cancel the unwanted terms and get <img class="math" src="../_images/math/781f9bfa24edd919ff7c82dd0215eb71cccdcdaf.png" alt="f(q)"/>,</p>
<section id="rbc-ukqcd-ratio">
<h5>RBC-UKQCD Ratio<a class="headerlink" href="#rbc-ukqcd-ratio" title="Permalink to this headline"></a></h5>
<p>We examine the ratio,</p>
<div class="math">
<p><img src="../_images/math/a3d15a11c4d2c164b833378a237decc20358dbdc.png" alt="2 m_\pi \frac{ C_{3} (t, t_f, \vec{p}, \vec{0} )  C_{\rightarrow}(t, \vec{0}) }{ C_{3} (t, t_f, \vec{0}, \vec{0} )  C_{\rightarrow}(t, \vec{p}) }"/></p>
</div><p>Assuming <img class="math" src="../_images/math/fb3cbf614b8e63eee5bb1e06533f35c5353b850c.png" alt="Z_\pi"/> is momentum independant (this also works (probably) if
<img class="math" src="../_images/math/e74115686166f24ffc6c73b49f631cc24a2126b0.png" alt="Z_\pi = E(\vec{p}) f_\pi"/> , which is the case for
<img class="math" src="../_images/math/4933e14a3fda97d695ebefcaae7a0d4ca0a6006d.png" alt="O = \bar{u} \gamma_0 \gamma_5 d"/> type interpolators) the numerator is,</p>
<div class="math">
<p><img src="../_images/math/fc9355408253639fecc352571debb3fcf550bdb9.png" alt="\frac{ Z_V |Z_\pi|^2 }{ 4 E(\vec{p}) E(\vec{0})} f(q^2) ( E(\vec{p}) + m_\pi ) \frac{|Z_\pi|^2}{2 E(\vec{0})} e^{ -E(\vec{p})t - E(\vec{0})(t_f - t) -E(\vec{0})t }"/></p>
</div><p>and the denominator is,</p>
<div class="math">
<p><img src="../_images/math/f31e492b73ee772583eba378655728e4e7887e0f.png" alt="\frac{ Z_V |Z_\pi|^2 }{ 4 E(\vec{0}) E(\vec{0})} f(0) ( m_\pi + m_\pi ) \frac{|Z_\pi|^2}{2 E(\vec{p})} e^{ -E(\vec{0})t - E(\vec{0})(t_f - t) -E(\vec{p})t }"/></p>
</div><p>Cancelling leaves,</p>
<div class="math">
<p><img src="../_images/math/a4170816691784ab8f96ed3ff8a12d971354bf1f.png" alt="2 m_\pi \frac{ C_{3} (t, t_f, \vec{p}, \vec{0} )  C_{\rightarrow}(t, \vec{0}) }{ C_{3} (t, t_f, \vec{0}, \vec{0} )  C_{\rightarrow}(t, \vec{p}) } = f(q^2) ( E(\vec{p}) + m_\pi )"/></p>
</div><p>note there is no <img class="math" src="../_images/math/dbc7e1f5267a6d88c87c5a6419f2f5fc9e9ac64b.png" alt="Z_V"/> here.</p>
</section>
<section id="bonnet-et-al-ratio">
<h5>Bonnet et. al. Ratio<a class="headerlink" href="#bonnet-et-al-ratio" title="Permalink to this headline"></a></h5>
<div class="math">
<p><img src="../_images/math/ae2a47b955dbae18a1a7c3b6ff367d2bac04c633.png" alt="\frac{2 Z_V m_\pi}{E(\vec{p}) + m_\pi} \frac{ C_{3} (t, t_f, \vec{p}, \vec{0} )  C_{\rightarrow}(t, \vec{0}) }{ C_{\rightarrow} (t, \vec{p} )  C_{\rightarrow}(t_f, \vec{0}) }"/></p>
</div><p>the numerator of the right term is,</p>
<div class="math">
<p><img src="../_images/math/ce4364baa019ebf2bafb9d5a138289de5ff942d3.png" alt="\frac{ |Z_\pi|^2 }{ 4 E(\vec{p}) m_\pi} f_B(q^2) ( E(\vec{p}) + m_\pi ) \frac{|Z_\pi|^2}{2 m_\pi} e^{ -E(\vec{p})t - m_\pi(t_f - t) -m_\pi t }"/></p>
</div><p>the denominator of the right term is,</p>
<div class="math">
<p><img src="../_images/math/4eb269062bdc1cffa331307965e78f251914b839.png" alt="\frac{ |Z_\pi|^2 }{ 2 m_\pi } \frac{|Z_\pi|^2}{2 E(\vec{p})} e^{ -m_\pi t - m_\pi (t_f - t) -E(\vec{p})t }"/></p>
</div><p>Cancelling leaves,</p>
<div class="math">
<p><img src="../_images/math/b2f0bb52277ba12dca54a21c10d1d015c88440d6.png" alt="\frac{ f_B(q^2) ( E(\vec{p}) + m_\pi ) }{ 2 E(\vec{p}) }"/></p>
</div><p>the kinematic factors are cancelled</p>
<div class="math">
<p><img src="../_images/math/0dae69e644eb179dfd3daf4948d21ccb099c4718.png" alt="\frac{2 Z_V m_\pi}{E(\vec{p}) + m_\pi} \frac{ f_B(q^2) ( E(\vec{p}) + m_\pi ) }{ 2 E(\vec{p}) } = Z_V f_B(q^2) = f(q^2)"/></p>
</div><p>you need to actually know <img class="math" src="../_images/math/dbc7e1f5267a6d88c87c5a6419f2f5fc9e9ac64b.png" alt="Z_V"/> or use the conserved current.</p>
</section>
</section>
</section>
</section>
<section id="estimation-of-disconnected-contributions">
<h2>Estimation of Disconnected Contributions<a class="headerlink" href="#estimation-of-disconnected-contributions" title="Permalink to this headline"></a></h2>
<section id="conventions">
<h3>Conventions<a class="headerlink" href="#conventions" title="Permalink to this headline"></a></h3>
<p>We choose the hermitian basis of gamma matrices given in Tab. 1. Each element of the basis is referred by an index in [0,15] shown in the following table</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-left head"><p>No</p></th>
<th class="text-left head"><p>Matrix</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>0</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/f97c8f196c4205086cdcb7fbb81aab3b68ac7db6.png" alt="\gamma_5"/></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>1</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/9e513c9f5e5cdc0504d24a36f89be7ab14ae1ce3.png" alt="\gamma_1"/></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>2</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/be53c2da4f35d6bd4530b8000d4a6628a474547d.png" alt="\gamma_2"/></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>3</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/ac18d2ea2489acd49fe0c206072989ef5d40f451.png" alt="\gamma_3"/></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>4</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/9815473452e66b2664cea19a9603129cbe233216.png" alt="-\mathrm{i}\gamma_0\gamma_5"/></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>5</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/1f933ab6f40b9662dba33dfdb0149970526f33a5.png" alt="-\mathrm{i}\gamma_0\gamma_1"/></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>6</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/61394073c8226fe546fa1cf70de4d6d2d43316d5.png" alt="-\mathrm{i}\gamma_0\gamma_2"/></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>7</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/501de6f3bbbe707d05a116d871c236b832a255ee.png" alt="-\mathrm{i}\gamma_0\gamma_3"/></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>8</p></td>
<td class="text-left"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>9</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/860140da602dc95f520b9a9b149014dfb9778760.png" alt="-\mathrm{i}\gamma_5\gamma_1"/></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>10</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/4c6fbd8b1bc5294c180968b81faeb97d8fb0e65d.png" alt="-\mathrm{i}\gamma_5\gamma_2"/></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>11</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/85c835fbb5eca27eb26e18906f049427def17db2.png" alt="-\mathrm{i}\gamma_5\gamma_3"/></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>12</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/47e5fbc4026ef5044e6a74ae238d7d145392013e.png" alt="\gamma_0"/></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>13</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/2de41493c260eb72b56ba205a9cff94ad35bf669.png" alt="-\mathrm{i}\gamma_5\gamma_0\gamma_1"/></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>14</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/1b16f71a53c3b2b4e29431a9fa94d5418a663cc0.png" alt="-\mathrm{i}\gamma_5\gamma_0\gamma_2"/></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>15</p></td>
<td class="text-left"><p><img class="math" src="../_images/math/8c8165ad466a3f74ff6f3f99943fd412eedfc04e.png" alt="-\mathrm{i}\gamma_5\gamma_0\gamma_3"/></p></td>
</tr>
</tbody>
</table>
</section>
<section id="singlet-two-point-functions">
<h3>Singlet Two-Point Functions<a class="headerlink" href="#singlet-two-point-functions" title="Permalink to this headline"></a></h3>
<p>Consider a gauge theory on a group G coupled to <img class="math" src="../_images/math/64520f5ef1b00b17ed2213502090369d3ecc1ace.png" alt="N_f"/> fermions in an arbitrary representation <img class="math" src="../_images/math/1ebe654cc7b8f2a0d8100aa5825cf2b9021adbbc.png" alt="R"/>. Let us denote:</p>
<div class="math">
<p><img src="../_images/math/20d8b75d71cec741e589f9ad61827c3806bd3d9f.png" alt="C(t, x_0) = \dfrac{1}{N_f}\sum_{\vec{x}}\langle \bar{q}\Gamma q(x)\bar{q}\Gamma q(x_0)\rangle"/></p>
</div><p>where <img class="math" src="../_images/math/a5fa84b363f309ebc8fe7db38304541732c7de9a.png" alt="q"/>,<img class="math" src="../_images/math/74597c3499802efd4aa0405a54456cff1d7c07b4.png" alt="\bar{q}"/> are the <img class="math" src="../_images/math/64520f5ef1b00b17ed2213502090369d3ecc1ace.png" alt="N_f"/> quark fields and <img class="math" src="../_images/math/e7003fd3463f843ee1e53385878369f078d362ad.png" alt="\Gamma"/> denotes as arbitrary Dirac structure. The <img class="math" src="../_images/math/1fb584ecc59a81a7b145483da074a28279ce1e0a.png" alt="1/N_f"/> factor is only there for convenience. The Wick contractions read:</p>
<div class="math">
<p><img src="../_images/math/5fa1ce475db0594fb11a40e8c02b57840e96601e.png" alt="C(t, x_0) = \sum_{\vec{x}} \langle -\mathrm{tr}\left(\Gamma S(x,x_0)\Gamma S(x_0,x)\right) + N_f\,\mathrm{tr}\left(\Gamma S(x,x)\right)\mathrm{tr}\left(\Gamma S(x_0,x_0)\right)\rangle"/></p>
</div></section>
<section id="stochastic-evaluation-of-disconnected-loops">
<h3>Stochastic Evaluation of Disconnected Loops<a class="headerlink" href="#stochastic-evaluation-of-disconnected-loops" title="Permalink to this headline"></a></h3>
<p>The simple one consist to evaluate stochastically the disconnected contribution without any variance reduction techniques. Considering a general volume source <img class="math" src="../_images/math/4b0fcdf5bbee5b94367e76452870b31d7c74f348.png" alt="\xi"/>, we define <img class="math" src="../_images/math/fffd2357ee88a9c50ba9e831ed64c39c73d54a07.png" alt="\phi"/> using the Dirac operator <img class="math" src="../_images/math/0fcab9067b50b87e868c4fd70f213a086addb964.png" alt="D"/>:</p>
<div class="math">
<p><img src="../_images/math/5b9057b2312a5a430d3fce69d4172d5f5963a59b.png" alt="\phi = D^{-1}\xi"/></p>
</div><p>For a given element X of the basis defined in the previous section, we then have</p>
<div class="math">
<p><img src="../_images/math/a32e804d16412d97a18f02eef3a90e2471b7fdd1.png" alt="\sum \left(\xi^{*}X\phi\right)_{R} = \sum XM^{-1} + \text{noise}"/></p>
</div><p>where the symbol <img class="math" src="../_images/math/3f4037cf2ab167196cf78944d0f83005afffd6aa.png" alt="(\ldots)_{R}"/> refers to the average over R samples of the stochastic source.</p>
<p>It should be observed that in evaluating the disconnected contributions to the neutral meson correlators each one of the two quark loops arising from Wick contractions must be averaged over completely <em>independent</em> smaples of stochastic sources for the purpose of avoiding unwanted biases.</p>
<section id="implemented-source-types">
<h4>Implemented Source Types<a class="headerlink" href="#implemented-source-types" title="Permalink to this headline"></a></h4>
<p>We use XX noise sources. The user can switch between the following different source types</p>
<ul class="simple">
<li><p>type 0: Pure volume source</p></li>
<li><p>type 1: Gauge fixed wall source</p></li>
<li><p>type 2: Volume sources with time and spin dilution</p></li>
<li><p>type 3: Volume sources with time, spin and color dilution</p></li>
<li><p>type 4: Volume source with time, spin, color and even-odd dilution</p></li>
<li><p>type 6: Volume source with spin, color and even-odd dilution</p></li>
</ul>
</section>
</section>
<section id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline"></a></h3>
<p>The code does not perform any average on the stochastic noise or on the dilution indices. This allows to keep as much information as possible and to vary the number of stochastic sources at the analysis level.</p>
<p>The indices are always</p>
<p><code class="docutils literal notranslate"><span class="pre">#T</span> <span class="pre">#iGamma</span> <span class="pre">#iSrc</span> <span class="pre">#\[color</span> <span class="pre">and/or</span> <span class="pre">e/o</span> <span class="pre">\]</span> <span class="pre">#Re</span> <span class="pre">#Im</span></code></p>
<p>where iGamma refers to the index of the Gamma matrix defined in Table 1.</p>
</section>
<section id="debugging-options">
<h3>Debugging Options<a class="headerlink" href="#debugging-options" title="Permalink to this headline"></a></h3>
<p>If the code is executed with the following additional arguments</p>
<p>the code will read the two files and perform the contraction accordingly computing <img class="math" src="../_images/math/100ccb4893690d345cc602a3c402c12f9d806c1a.png" alt="\chi^{\dagger}\Gamma \psi"/></p>
</section>
</section>
<section id="mesonic-correlators-of-the-isotriplet">
<h2>Mesonic Correlators of the Isotriplet<a class="headerlink" href="#mesonic-correlators-of-the-isotriplet" title="Permalink to this headline"></a></h2>
<p>The two fermionic flavors are denoted by <img class="math" src="../_images/math/9b444cf6329a14140aee8ff5a06ff30772cc1c2f.png" alt="u"/> and <img class="math" src="../_images/math/badad346f6fbe2e237af99bfbd9a93a4da53a3da.png" alt="d"/>. We are interested in the mesonic correlators</p>
<div class="math">
<p><img src="../_images/math/6560fb120429fd04566547b0b1df2832329641aa.png" alt="\begin{aligned}
&amp;&amp; C_{\Gamma_1,\Gamma_2}(x-y) = \left&lt;
\left( \bar{u} \Gamma_1 d \right)^\dagger(x)
\left( \bar{u} \Gamma_2 d \right)(y)
\right&gt; = \nonumber \\
&amp;&amp; \quad = \left&lt;
\left( \bar{d} \gamma_0 \Gamma_1^\dagger \gamma_0 u \right)(x)
\left( \bar{u} \Gamma_2 d \right)(y)
\right&gt;\end{aligned}"/></p>
</div><p>where <img class="math" src="../_images/math/97384d7317fe41fd426d8ef5e401ad287dc000b9.png" alt="\Gamma_i"/> are the generic producs of the <img class="math" src="../_images/math/34d137cf01c787ecda732761c3f95b0f65a6c3e9.png" alt="\gamma"/>-matrices.</p>
<p>We can integrate out the fermionic fields explicitly. Here we use the definition <img class="math" src="../_images/math/c740ae34fb93281b477a0e98b1a47631f1c36780.png" alt="H(x,y) = G(x,y) \gamma_5"/> for the hermitian Dirac operator, with <img class="math" src="../_images/math/fd43bc1f35f7ab7c33550f1dfac9ea1a0346b5c0.png" alt="G(x,y)"/> defined as its inverse.</p>
<div class="math">
<p><img src="../_images/math/6d8da99ecd8a559eceac9e1f393631910de3e9ce.png" alt="\begin{aligned}
&amp;&amp; C_{\Gamma_1,\Gamma_2}(x-y) = - \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,y) \Gamma_2 G(y,x) \right]
\right&gt; = \nonumber \\
&amp;&amp; \quad = - \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,y) \Gamma_2 \gamma_5 G(x,y)^\dagger \gamma_5 \right]
\right&gt; = \nonumber \\
&amp;&amp; \quad = - \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 H(x,y) \gamma_5 \Gamma_2 H(x,y)^\dagger \gamma_5 \right]
\right&gt; \; .\end{aligned}"/></p>
</div><p>Since the <img class="math" src="../_images/math/34d137cf01c787ecda732761c3f95b0f65a6c3e9.png" alt="\gamma"/>-matrices commute, we can conclude that the matrix <img class="math" src="../_images/math/87f898058bf5896c450ab95c78bdd3c85a8e88aa.png" alt="\gamma_0 \Gamma^\dagger \gamma_0"/> is equal to <img class="math" src="../_images/math/e7003fd3463f843ee1e53385878369f078d362ad.png" alt="\Gamma"/> up to a sign</p>
<div class="math">
<p><img src="../_images/math/1d068cc54f5a788811104ba2ad615df2411bc25c.png" alt="\label{gamma0_adj}\gamma_0 \Gamma^\dagger \gamma_0 = s(\Gamma) \Gamma \qquad \text{with } s(\Gamma) = \pm 1 \; ."/></p>
</div><p>In addition, a generic matrix <img class="math" src="../_images/math/e7003fd3463f843ee1e53385878369f078d362ad.png" alt="\Gamma"/> has the following properties:</p>
<ol class="arabic simple">
<li><p>Its matrix elements can be <img class="math" src="../_images/math/31fdf41b39df23c95e52c5aef07f59d9adf82f3c.png" alt="0"/>, <img class="math" src="../_images/math/07c8cc2f44b70e742434e428da238fecafd073c0.png" alt="\pm 1"/>, <img class="math" src="../_images/math/1c6c492fd13c775a79e6cd537e481f2688bfae92.png" alt="\pm i"/></p></li>
<li><p>Its entries are either all real or all imaginary</p></li>
<li><p>In each row and correspondingly each column, there is only one non-zero element</p></li>
</ol>
<p>Consequently, we can write</p>
<div class="math">
<p><img src="../_images/math/9f507e91f2de3898ea975a9ac976015f79025484.png" alt="\label{gamma_ab}
\Gamma_{\alpha\beta} = t_\alpha(\Gamma) \delta_{\sigma_\alpha(\Gamma), \beta}"/></p>
</div><p>where <img class="math" src="../_images/math/855fd662bc3e3a154f48460fec14dd64c54a81c7.png" alt="\sigma(\Gamma)"/> constitutes a permutation of four elements. Putting this together we find</p>
<div class="math">
<p><img src="../_images/math/dc2a2755f0af646b91771a7a40a6cc2eff736f76.png" alt="\begin{aligned}
&amp; C_{\Gamma_1,\Gamma_2}(x-y) = - s(\Gamma_1) \left&lt; \mathrm{tr}
\left[ \gamma_5 \Gamma_1 H(x,y) \gamma_5 \Gamma_2 H(x,y)^\dagger \right]
\right&gt; = \\
&amp; \quad = - s(\Gamma_1) \sum_{\alpha\beta} t_\alpha(\gamma_5 \Gamma_1) t_\beta(\gamma_5 \Gamma_2) \times \left&lt; \mathrm{tr}
\left[ H_{\sigma_\alpha(\gamma_5 \Gamma_1), \beta}(x,y) H_{\alpha, \sigma_\beta(\gamma_5 \Gamma_2)}(x,y)^\dagger \right]
\right&gt; \; .\label{triplet_corr}\end{aligned}"/></p>
</div><section id="implementation-of-the-point-to-all-propagator">
<h3>Implementation of the Point-To-All Propagator<a class="headerlink" href="#implementation-of-the-point-to-all-propagator" title="Permalink to this headline"></a></h3>
<p>In order to calculate mesonic masses we are interested in correlators satisfying <img class="math" src="../_images/math/9699c7dbd0d9fdc2d226a904e80011f928f7d81b.png" alt="\Gamma_1=\Gamma_2"/>. Using translational invariance, we can set <img class="math" src="../_images/math/3d1a457388b366a4cf4757043bd645ba9f19eea9.png" alt="y=0"/>. In this case the formula simplifies to</p>
<div class="math" id="equation-eq-triplet-point-to-all-corr">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-eq-triplet-point-to-all-corr" title="Permalink to this equation"></a></span><img src="../_images/math/2e66d5f7cd9f1dc0586cb4ca19e7cccc04a6fd6f.png" alt="C_{\Gamma}(x) = - s(\Gamma) \sum_{\alpha\beta} t_\alpha(\gamma_5 \Gamma)t_\beta(\gamma_5 \Gamma) \times \left&lt; \mathrm{tr}\left[ H_{\sigma_\alpha(\gamma_5 \Gamma), \beta}(x,0) H_{\alpha, \sigma_\beta(\gamma_5 \Gamma)}(x,0)^\dagger \right]\right&gt; \; ."/></p>
</div><p>This is implemented into HiRep in the following way</p>
<ul>
<li><p>The data of the point-like source <img class="math" src="../_images/math/49220867f2975be499db9420dc3356ab709d9315.png" alt="\xi^{(\alpha,a)}"/> defined by</p>
<div class="math">
<p><img src="../_images/math/78a892845ea1f30a1e7b5ddcfcbfcfe03457a282.png" alt="\xi^{(\alpha,a)}_{\beta b}(x) = \delta_{\alpha,\beta} \delta_{a,b} \delta_{x,0} \; ,"/></p>
</div><p>The function <code class="docutils literal notranslate"><span class="pre">quark_propagator</span></code> applies the inverse of the hermitian Dirac operator to the source</p>
<div class="math">
<p><img src="../_images/math/d8586f0365a638050dcfe7c8cb46deeef1cc5739.png" alt="\eta^{(\alpha,a)} = H \xi^{(\alpha,a)} \qquad \eta^{(\alpha,a)}_{\beta b}(x) = H_{\beta \alpha}^{b a}(x,0) \; ."/></p>
</div></li>
</ul>
<ul>
<li><p>The functions <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*_correlator(float</span> <span class="pre">*out,</span> <span class="pre">suNf_spinor</span> <span class="pre">**qp)</span></code>in <code class="docutils literal notranslate"><span class="pre">Observables/mesons.c</span></code> implement the formulae <a class="reference internal" href="#equation-eq-triplet-point-to-all-corr">(5)</a>, where <code class="docutils literal notranslate"><span class="pre">out</span></code> stands for the correlator and <code class="docutils literal notranslate"><span class="pre">qp</span></code> for the spinor array. The functions <img class="math" src="../_images/math/c2c159e4c00e652280ce7402b96c2204e26634b6.png" alt="s(\Gamma)"/>, <img class="math" src="../_images/math/03a0bb332f9837aacca11ff85e6936b00bbe7ed0.png" alt="t_\alpha(\gamma_5 \Gamma)"/> and <img class="math" src="../_images/math/8182512ccbe94fcfe3440f709e823a1298dd330a.png" alt="\sigma_\alpha(\gamma_5 \Gamma)"/> where calculated using <code class="docutils literal notranslate"><span class="pre">Mathematica</span></code>, see file <code class="docutils literal notranslate"><span class="pre">mesons.nd</span></code> and implemented in the code using macros, defined as follows\</p>
<p><code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160; </code><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_C1_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/c88b0300c0416b4ffddad78939b6748cdee44ea9.png" alt="\sigma_1(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_C2_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/f12d3501d21457492c99ab7a22313ad16ae51707.png" alt="\sigma_2(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_C3_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/ce7e60c25ead42c9bf87e96c77c6a01b0da8fbcc.png" alt="\sigma_3(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_C4_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/b8d08a8e335f633aef437a6d30cd89573c42df17.png" alt="\sigma_4(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160; </code></p>
<p>If <img class="math" src="../_images/math/03a0bb332f9837aacca11ff85e6936b00bbe7ed0.png" alt="t_\alpha(\gamma_5 \Gamma)"/> are read:</p>
<p><code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160; </code><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S0_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/d5aa89d8b238a5b7eb7ee899b87c63aed1acdd5e.png" alt="-s(\Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S1_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/0dd2d253226dd6750ba079993edf8a6da08b1063.png" alt="t_1(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S2_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/97df03ff721f4506539efdcabf634cbf73e1f194.png" alt="t_2(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S3_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/435a5a693aeed4f4a71e127d9e66ccea9e15a295.png" alt="t_3(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S4_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/c9c6aaf877f384dd6768dae59e9f8a1488343d5c.png" alt="t_4(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160; </code></p>
<p>whereas if <img class="math" src="../_images/math/03a0bb332f9837aacca11ff85e6936b00bbe7ed0.png" alt="t_\alpha(\gamma_5 \Gamma)"/> are imaginary:</p>
<p><code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160; </code><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S0_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/c2c159e4c00e652280ce7402b96c2204e26634b6.png" alt="s(\Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S1_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/fe8ef38b3c5c60251279b8fc0337cc18f33473c0.png" alt="-i t_1(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S2_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/bdf7c6d603d6ba484f86e07f540749fa7cd30ed0.png" alt="-i t_2(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S3_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/58e23e10feadf3b8a14a299f8637378387614e9b.png" alt="-i t_3(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160; <span class="pre">_S4_</span> <span class="pre">=</span></code><img class="math" src="../_images/math/81d7e6e13f76b660717243a66eccb786c65b0479.png" alt="-i t_4(\gamma_5 \Gamma)"/><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160; </code></p>
</li>
</ul>
</section>
</section>
<section id="mesonic-correlators-of-the-isosinglet">
<h2>Mesonic Correlators of the Isosinglet<a class="headerlink" href="#mesonic-correlators-of-the-isosinglet" title="Permalink to this headline"></a></h2>
<p>We are now concerned with the genertic mesonic correlator given by</p>
<div class="math">
<p><img src="../_images/math/19290451eb9d9ae6f2277f458736643dc359209b.png" alt="\begin{aligned}
C_{\Gamma_1,\Gamma_2}(x-y) &amp;=&amp; \left&lt;
\left( \bar{u} \gamma_0 \Gamma_1^\dagger \gamma_0 u \right)(x)
\left( \bar{u} \Gamma_2 u \right)(y)
\right&gt;\end{aligned}"/></p>
</div><p>considering only a single flavor <img class="math" src="../_images/math/9b444cf6329a14140aee8ff5a06ff30772cc1c2f.png" alt="u"/>.</p>
<p>Integration of the fermionic fields now yiels one additional term, the hairpin diagram</p>
<div class="math">
<p><img src="../_images/math/4a5528d4e81fa7321d1aba6380d4ba5fd23c328e.png" alt="\begin{aligned}
C_{\Gamma_1,\Gamma_2}(x-y) =&amp;- \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,y) \Gamma_2 G(y,x) \right]
\right&gt;  + \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,x) \right]
\mathrm{tr}\left[ \Gamma_2 G(y,y) \right]
\right&gt;\\
=&amp; - \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 H(x,y) \gamma_5 \Gamma_2 H(x,y)^\dagger \gamma_5 \right]
\right&gt; + \left&lt; \mathrm{tr}
\left[ \gamma_5 \gamma_0 \Gamma_1^\dagger \gamma_0 H(x,x) \right]
\mathrm{tr}\left[ \gamma_5 \Gamma_2 H(y,y) \right]
\right&gt;
\; .\end{aligned}"/></p>
</div><p>All other contributions are identical to the contributions to the isotriplet correlator. We can, therefore, focus on the contribution through the hairpin diagram. Using the formulae <code class="xref eq docutils literal notranslate"><span class="pre">eq:gamma0_adj</span></code> we can write</p>
<div class="math" id="equation-eq-hairpin">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-eq-hairpin" title="Permalink to this equation"></a></span><img src="../_images/math/eb044d34a49c66cff63466b57d9de8ee764d593f.png" alt="\left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,x) \right]
\mathrm{tr}\left[ \Gamma_2 G(y,y) \right] \right&gt; = \quad = s(\Gamma_1) \sum_{\alpha \beta} t_\alpha(\Gamma_1) t_\beta(\Gamma_2) \times \left&lt;
\mathrm{tr}G_{\sigma_\alpha(\gamma_5 \Gamma_1),\alpha}(x,x) \;
\mathrm{tr}G_{\sigma_\beta(\gamma_5 \Gamma_2),\beta}(y,y)
\right&gt;
\; ."/></p>
</div><section id="all-to-all-propagator">
<h3>All-to-all Propagator<a class="headerlink" href="#all-to-all-propagator" title="Permalink to this headline"></a></h3>
<p>It is clear from <a class="reference internal" href="#equation-eq-hairpin">(6)</a>, from the fact that we are employing point source, that one must compute the entire inverse matrix of the Dirac operator. The alternative is to use a statistic estimate for <img class="math" src="../_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> followed by variance reduction procedures.</p>
<p>Suppose there are <img class="math" src="../_images/math/5e39e6f9d54fdbac1a3cad42723c4487d23b7598.png" alt="N_s"/> available random fermion sources <img class="math" src="../_images/math/2d04804c2be45713ee285315011a497eb5c8991b.png" alt="\xi^{(i)}"/> such that the only non-zero correlators are</p>
<div class="math">
<p><img src="../_images/math/cf4b80946cb292d34f70cf04e6a304c0b085edb6.png" alt="\left&lt; \xi^{(i)}_{\alpha a}(x)^\dagger \xi^{(j)}_{\beta b}(y) \right&gt; = \delta_{\alpha,\beta} \delta_{a,b} \delta_{x,y} \delta_{i,j} \; ."/></p>
</div><p>Current literature proposes mainly either Gaussian noise or <img class="math" src="../_images/math/46011fd9190f47f8fb08bb484d5ceac65ef9a9f2.png" alt="Z_2"/> noise. In the following, we will choose <img class="math" src="../_images/math/46011fd9190f47f8fb08bb484d5ceac65ef9a9f2.png" alt="Z_2"/> noise, following <span id="id1">[<a class="reference internal" href="../user_guide.html#id5" title="M. Foster and C. Michael. Quark mass dependence of hadron masses from lattice qcd. Physical Review D, feb 1999. URL: https://doi.org/10.1103%2Fphysrevd.59.074503, doi:10.1103/physrevd.59.074503.">FM99</a>]</span>. Each component of the spinor is randomly chosen from the values <img class="math" src="../_images/math/6f7eb7769af45eee22c8e916c96b78c3da3e6e65.png" alt="\pm 1/\sqrt{2}"/>.</p>
<p>Then the matrix <img class="math" src="../_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> can be estimated as follows:</p>
<div class="math" id="equation-eq-naive-noisy-estimate">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-eq-naive-noisy-estimate" title="Permalink to this equation"></a></span><img src="../_images/math/87ae667ad853d9024dcd8819a7976380b5decb28.png" alt="H_{\alpha \beta}^{a b}(x,y) \simeq \sum_{i=1}^{N_s} \eta^{(i)}_{\alpha a}(x) \xi^{(i)}_{\beta b}(y)^\dagger \eta^{(i)} \equiv H \xi^{(i)}"/></p>
</div><p>Stochastic estimation can then be used to calculate the relevant tracks for correlators</p>
<div class="math">
<p><img src="../_images/math/558f1374c3ac3c35899065ae2a5cda6207c68568.png" alt="\mathrm{tr}\left[ \Gamma_1 G(x,y) \Gamma_2 G(y,x) \right] = \sum_{ij} \xi^{(i)}(x)^\dagger \gamma_5 \Gamma_1 \eta^{(j)}(x) \times \xi^{(j)}(y)^\dagger \gamma_5 \Gamma_2 \eta^{(i)}(y)"/></p>
</div><div class="math">
<p><img src="../_images/math/88fa6cb9df8abf9b65111b23c1ca386d280627ac.png" alt="\mathrm{tr}\left[ \Gamma G(x,x) \right] = \sum_i \xi^{(i)}(x)^\dagger \gamma_5 \Gamma \eta^{(i)}(x)\, ."/></p>
</div></section>
<section id="variance-reduction">
<h3>Variance reduction<a class="headerlink" href="#variance-reduction" title="Permalink to this headline"></a></h3>
<p>The noise obtained from stochastic estimation of the matrix <img class="math" src="../_images/math/89878909dbb648acdc4a44ded1bd982d7bddef5d.png" alt="G"/> in the formula <code class="xref eq docutils literal notranslate"><span class="pre">naive_noisy_estimate</span></code> can be reduced using the trick from <span id="id2">[<a class="reference internal" href="../user_guide.html#id4" title="C. McNeile and C. Michael. Mixing of scalar glueballs and flavor-singlet scalar mesons. Physical Review D, may 2001. URL: https://doi.org/10.1103%2Fphysrevd.63.114503, doi:10.1103/physrevd.63.114503.">MM01</a>]</span> for Wilson fermions. Here, the Dirac operator has the form <img class="math" src="../_images/math/00cd3e1e08aee50ce329292d79f16084c126a92c.png" alt="D = 1 - K"/>. As a result, for the matrix <img class="math" src="../_images/math/89878909dbb648acdc4a44ded1bd982d7bddef5d.png" alt="G"/> the following formula applies</p>
<div class="math">
<p><img src="../_images/math/82e5887e8f6b73ebaa67a1485d2840c6f459a117.png" alt="\begin{aligned}
&amp;&amp; G = D^{-1} = \left( 1 - K \right)^{-1} = \\
&amp;&amp; \quad = 1 + K + \dots + K^m + K^{n_1} G K^{n_2}\end{aligned}"/></p>
</div><p>with <img class="math" src="../_images/math/37672a751668a87da9d92c5c6de95e26c9372205.png" alt="n_1 + n_2 = n = m+1"/>. In particular, for the evaluation of the hairpin diagram</p>
<div class="math">
<p><img src="../_images/math/a1ff38cc543ea34c6769fca57b322697abcef86c.png" alt="\begin{aligned}
\mathrm{tr}\left[ \Gamma G(x,x) \right] &amp;=&amp; \mathrm{tr}\Gamma + \mathrm{tr}\left[ \Gamma K^4 \right](x,x) + \mathrm{tr}\left[ \Gamma K^6 \right](x,x) + \dots + \\
&amp;&amp; + \mathrm{tr}\left[ \Gamma K^{2k} \right](x,x) + \mathrm{tr}\left[ \Gamma K^{n_1} G K^{n_2} \right](x,x)\end{aligned}"/></p>
</div><p>with <img class="math" src="../_images/math/3150b5b0c5a9e83ce434ab8d82ca7f3cf1072445.png" alt="m=2k"/>. (TODO: fix this sentence) Here, we can use the fact that the matrix <img class="math" src="../_images/math/52ddc0cde6d632f631533173562fe3ca375b1f32.png" alt="K"/> connects first neighboring sites as thus <img class="math" src="../_images/math/ca77bdb43d2fa3ca1d9f8552477243289f8ea357.png" alt="K^p(x,x) \neq 0"/> only when <img class="math" src="../_images/math/141bbefb74014fc5e43499901bf78607ae335583.png" alt="p"/> is even. Further, <img class="math" src="../_images/math/699a1e377a596367efcd2da1114f6d4b52b4ccdc.png" alt="r_0=1"/> and consequently <img class="math" src="../_images/math/d1df4bfee3b506672fe1bc2050e19cd3cf4fabf5.png" alt="K^2(x,x) = 0"/> The first <img class="math" src="../_images/math/e00d4db37b602d888e9a5f2bc30bb8ad68d14ce9.png" alt="k+1"/> terms can be calculated explicitly and we can estimate the last term stochastically.</p>
<div class="math" id="equation-eq-hairpin-with-variance-reduction">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-eq-hairpin-with-variance-reduction" title="Permalink to this equation"></a></span><img src="../_images/math/8f5a505b9ca4cab7c4b0049704b62cb4edb586c4.png" alt="\begin{aligned}
\mathrm{tr}\left[ \Gamma G(x,x) \right] =&amp; \mathrm{tr}\Gamma + \mathrm{tr}\left[ \Gamma K^4 \right](x,x) + \mathrm{tr}\left[ \Gamma K^6 \right](x,x) + \dots + \nonumber \\
&amp; + \mathrm{tr}\left[ \Gamma K^{2k} \right](x,x) + \sum_{iy} \xi^{(i)}(y)^\dagger \gamma_5 K^{n_2}(y,x) \Gamma K^{n_1}(x,y) \eta^{(i)}(y) \nonumber \\
\end{aligned}"/></p>
</div><p><span id="id3">[<a class="reference internal" href="../user_guide.html#id4" title="C. McNeile and C. Michael. Mixing of scalar glueballs and flavor-singlet scalar mesons. Physical Review D, may 2001. URL: https://doi.org/10.1103%2Fphysrevd.63.114503, doi:10.1103/physrevd.63.114503.">MM01</a>]</span> use this trick only for the calculation of the hairpin diagram. It might be possible to generalize it to the the isotriplet part as well, as an alternative to the point-to-all propagator.</p>
</section>
<section id="time-dilution">
<h3>Time dilution<a class="headerlink" href="#time-dilution" title="Permalink to this headline"></a></h3>
<p>This is a trick introduced in <span id="id4">[<a class="reference internal" href="../user_guide.html#id3" title="Justin Foley, K. Jimmy Juge, Alan Ó Cais, Mike Peardon, Siné ad M. Ryan, and Jon-Ivar Skullerud. Practical all-to-all propagators for lattice qcd. Computer Physics Communications, 172(3):145–162, nov 2005. URL: https://doi.org/10.1016%2Fj.cpc.2005.06.008, doi:10.1016/j.cpc.2005.06.008.">FJC+05</a>]</span> for noise reduction in the computation of null-moment propagators. Whenever stochastic estimation of the <img class="math" src="../_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> matrix is required, such as in <a class="reference internal" href="#equation-eq-naive-noisy-estimate">(7)</a>, it is possible to replace each stochastic source <img class="math" src="../_images/math/2d04804c2be45713ee285315011a497eb5c8991b.png" alt="\xi^{(i)}"/> with a set of sources each with support on a different time slice.</p>
<div class="math">
<p><img src="../_images/math/8b5cd647ad441a9ca628f9f3e829d537f16af699.png" alt="\begin{aligned}
 \label{time_dilution}
&amp;&amp; \xi^{(i)} \rightarrow \xi^{(i,\tau)}(\mathbf{x},t) = \xi^{(i)}(\mathbf{x},t) \delta_{t,\tau}\end{aligned}"/></p>
</div><p>Stochastic estimation is now obtained similarly to the naive case:</p>
<div class="math" id="equation-eq-diluted-noisy-estimate">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-eq-diluted-noisy-estimate" title="Permalink to this equation"></a></span><img src="../_images/math/cda334b75e55a220804a8d41ae05606a3e2caa13.png" alt="H_{\alpha \beta}^{a b}(x,y) \simeq \sum_{i=1}^{N_s} \sum_{\tau=1}^{N_t} \eta^{(i,\tau)}_{\alpha a}(x) \xi^{(i,\tau)}_{\beta b}(y)^\dagger  \eta^{(i,\tau)} \equiv H \xi^{(i,\tau)}"/></p>
</div></section>
<section id="implementation-scheme">
<h3>Implementation Scheme<a class="headerlink" href="#implementation-scheme" title="Permalink to this headline"></a></h3>
<p>TODO: Add this to function reference instead if this is still implemented this way</p>
<p>The following functions will be implemented</p>
<ul>
<li><p>Calculation of the exact terms of the formula <code class="xref eq docutils literal notranslate"><span class="pre">hairpin_with_variance_reduction</span></code></p></li>
<li><p><code class="docutils literal notranslate"> </code><br />
<code class="docutils literal notranslate"> <span class="pre">void</span> <span class="pre">GAMMA_variance_reduction_exact_terms(float</span> <span class="pre">*out,</span> <span class="pre">int</span> <span class="pre">k)</span></code></p>
<p>Here, <code class="docutils literal notranslate"><span class="pre">out</span></code> is a real vector with its components equal to the volume and <img class="math" src="../_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/> corresponds to the index in the <img class="math" src="../_images/math/34d137cf01c787ecda732761c3f95b0f65a6c3e9.png" alt="\gamma"/>-matrix.</p>
<p>This function evaluates</p>
<div class="math">
<p><img src="../_images/math/3ed627b038c0f6137ec005c343b1db7ec9fcb402.png" alt="h_k(x) =&amp; \mathrm{tr}\left[ \Gamma K^{2k} \right](x,x) = \left( \frac{\kappa}{2} \right)^{2k} \sum_{\mathcal{C}_x} \mathrm{tr}\left( \Gamma \tilde{\gamma}(\mathcal{C}_x) \right) \mathcal{W}(\mathcal{C}_x)"/></p>
</div><p>where <img class="math" src="../_images/math/ae45c1b93d5186bcc4343a256d248e77d6e4d8ea.png" alt="\mathcal{C}_x = (x,\hat{\mu}_1,\hat{\mu}_2,\dots,\hat{\mu}_{2k})"/> is the generic closed path of <img class="math" src="../_images/math/888f7c323ac0341871e867220ae2d76467d74d6e.png" alt="x"/> of length <img class="math" src="../_images/math/1cfcab44d097a385b6e2fb16cfefc2f062ab999f.png" alt="2k"/> obtained by moving from <img class="math" src="../_images/math/888f7c323ac0341871e867220ae2d76467d74d6e.png" alt="x"/> in the directions <img class="math" src="../_images/math/9542a6b6296961142d5b5acbfffea3b6de304719.png" alt="\hat{\mu}_i"/>. <img class="math" src="../_images/math/58e782cf3e5ec1650d5976ba4e02776f8f542565.png" alt="\mathcal{W}(\mathcal{C}_x)"/> is the trace of the parallel transport through <img class="math" src="../_images/math/2d10b0f393eb0bb639cc8c68172b0056a76a7187.png" alt="\mathcal{C}_x"/> in the corresponding fermionic representation. <img class="math" src="../_images/math/fd60eb249674dd035b6c31720543f9636cb34636.png" alt="\tilde{\gamma}(\mathcal{C}_x)"/>. is the matrix defined as</p>
<div class="math">
<p><img src="../_images/math/8cd0a1d64a3ec0b34182734b20d695d2449c90f5.png" alt="\tilde{\gamma}(\mathcal{C}_x) = (1-\gamma_{\hat{\mu}_1})(1-\gamma_{\hat{\mu}_2})\cdots(1-\gamma_{\hat{\mu}_{2k}})"/></p>
</div><p>having defined <img class="math" src="../_images/math/522dd7e7e0f4ee8335d29fe4cf584e399d0d66fd.png" alt="\gamma_{-\hat{\mu}_i} = - \gamma_{\hat{\mu}_i}"/>.</p>
<p>It should be noted that since <img class="math" src="../_images/math/31b63f8cc72d75020c47c9c9afa5110a720576b6.png" alt="(1-\gamma_{\hat{\mu}_i})(1-\gamma_{-\hat{\mu}_i}) = 0"/>, one can exclude the paths in which a pair of subsequences <img class="math" src="../_images/math/0162b0ad44b3e5567e3700791cd48d3a35bb4d86.png" alt="(\dots, \hat{\mu}_i,-\hat{\mu}_i, \dots)"/> appears from the sum. In addition, the matrix <img class="math" src="../_images/math/fd60eb249674dd035b6c31720543f9636cb34636.png" alt="\tilde{\gamma}(\mathcal{C}_x)"/> does not depend on <img class="math" src="../_images/math/888f7c323ac0341871e867220ae2d76467d74d6e.png" alt="x"/>. There is is convenient to compute the list of paths and the matrix <img class="math" src="../_images/math/fd60eb249674dd035b6c31720543f9636cb34636.png" alt="\tilde{\gamma}(\mathcal{C}_x)"/> only once.</p>
</li>
<li><p>It is convenient to have a function that calculates the traces of the parallel transports:</p></li>
<li><p><code class="docutils literal notranslate"> <span class="pre">void</span> <span class="pre">tr_r_pexp(complex</span> <span class="pre">*out,</span> <span class="pre">int</span> <span class="pre">*path,</span> <span class="pre">int</span> <span class="pre">length)</span></code></p>
<p>Here again <code class="docutils literal notranslate"><span class="pre">out</span></code> is the complex vector with number of components according to the volume and <img class="math" src="../_images/math/05af7eee223a16182f4dfeccbd0c67281b644f06.png" alt="\phi(x)"/>\ is the number of directions (<code class="docutils literal notranslate"><span class="pre">length</span></code>) of which the path is composed.</p>
<p>This returns</p>
<div class="math">
<p><img src="../_images/math/02d1aec0912078b0bf1f39ada5bbee2854011847.png" alt="\phi(x) = \mathrm{tr}\mathbf{R} \left[ U_{x, \hat{\mu}_1} U_{x+\hat{\mu}_1, \hat{\mu}_2} \cdots \right]"/></p>
</div></li>
<li><p>Calculation of the time-diluted estimators</p>
<p><code class="docutils literal notranslate"> <span class="pre">void</span> <span class="pre">time_diluted_stochastic_estimate</span></code><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160; <span class="pre">(suNf_spinor</span> <span class="pre">*csi,</span> <span class="pre">suNf_spinor</span> <span class="pre">**eta,</span></code><br />
<code class="docutils literal notranslate">&#160;&#160;&#160;&#160;&#160; <span class="pre">int</span> <span class="pre">nm,</span> <span class="pre">float</span> <span class="pre">*mass,</span> <span class="pre">double</span> <span class="pre">ac)</span></code>\</p>
<p>With the parameters:
<code class="docutils literal notranslate"><span class="pre">csi</span></code>  is the spinor <img class="math" src="../_images/math/4b0fcdf5bbee5b94367e76452870b31d7c74f348.png" alt="\xi"/><br />
<code class="docutils literal notranslate"><span class="pre">path</span></code> is the list of <img class="math" src="../_images/math/d52e3336286e279ba4239760746ac37bc1c0a8f0.png" alt="N_t \times \textrm{nm}"/> spinors along the <img class="math" src="../_images/math/da8396c4d39d0fcf2a9283c0778ecc38b5d215e4.png" alt="\eta^{(\tau,m)}"/>
<code class="docutils literal notranslate"> </code>\</p>
<p>This function generates the spinor <img class="math" src="../_images/math/4b0fcdf5bbee5b94367e76452870b31d7c74f348.png" alt="\xi"/> with <img class="math" src="../_images/math/46011fd9190f47f8fb08bb484d5ceac65ef9a9f2.png" alt="Z_2"/> noise. Here the spinors are defined as</p>
<div class="math">
<p><img src="../_images/math/049a3e8b0562cc6aa444e3e7bc8765871d25ed23.png" alt="\xi^{(\tau)}(\mathbf{x},t) = \xi(\mathbf{x},t) \delta_{t,\tau}"/></p>
</div></li>
</ul>
<p>and then returned as</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$$\eta^{(\tau,m)} \equiv H_m \xi^{(\tau)}$$

using the inverter of the Dirac operator with parameters `nm`, `mass` and `acc`.

The calculation of the hairpin term

` `\
` void GAMMA_hairpin_VR_TD(float **out,`\
`      int n1, int n2, int nrs,`\
`      int nm, float *mass, double acc)`\

Takes the parameters
		`out` = list of real `nm` vectors with the number of components corresponding to the volume 
		` n1, n2 ` = parameters of the variance reduction algorithm
		` nrs ` = number of random sources for the statistical estimation
		` nm, mass ` = number and list of masses
		`acc` = inverter parameter
    ` `\
</pre></div>
</div>
<p>The functions above implement the formula <a class="reference internal" href="#equation-eq-hairpin-with-variance-reduction">(8)</a>, summing exact terms and the statistical term, generated with <code class="docutils literal notranslate"><span class="pre">nrs</span></code> to dilute, for a total of <img class="math" src="../_images/math/201b8f86ab24fcae4ad112bc41336f8498e043f5.png" alt="\times N_t"/> matrix invertions for each mass value and returns the result as <code class="docutils literal notranslate"><span class="pre">out</span></code>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="supported_features.html" class="btn btn-neutral float-left" title="Supported Features" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="writing_programs.html" class="btn btn-neutral float-right" title="Writing A Program in HiRep" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>